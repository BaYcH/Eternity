 /* f72.js */ var gZform;var styleInputBoxFieldLabel="font-family: Verdana,Arial;font-size:12px;color:#182C3D;font-weight:bold;";function setupPopupCalendars(dateFieldId){Calendar.setup({dateField: dateFieldId,triggerElement: dateFieldId           }         )};function f72(handle,title,info,ptr,boxStyle,cellpadding,boxCssText,tableCssText){var callBackFn;var cancelCallbackFn;var node=ptr;var donotCloseOnSend=0;var form = f21("form");var ptOkButton=1;var ptCancelButton=1;form.setAttribute("name",form.id);form.obj=this;form.method="POST";gZform=this;var frmStyleClass=null;var styleFileForm3="";var hBox=f21("span");var hTable=f21("table");var firstInputField=null;var hasRequiredField=0;var items = new Array();if(boxStyle==1)hBox.style.cssText=styleFileForm;else if(boxStyle==2)hBox.style.cssText=styleInputBox;else if(boxStyle==3)hBox.style.cssText=styleFileForm3;else hBox.style.cssText=stylePopupInputBox;if(boxCssText)hBox.style.cssText=boxCssText;if(tableCssText)hTable.style.cssText=tableCssText;/*hTable.style.cssText=styleInputBoxTable;*/ hTable.setAttribute("border","1");cellpadding = cellpadding? cellpadding : "1";hTable.setAttribute("cellpadding",cellpadding);hTable.form=form;var okText="Ok";var cancelText="Cancel";this.setAction = function(a){form.action=a;};this.setFrmStyleClass = function (c){frmStyleClass=c;hBox.style.cssText="";};this.setPtOkButton = function (v){ptOkButton = v;};this.setPtCancelButton = function (v){ptCancelButton = v;};this.setAdditionalStyle = function (s){var s1= hBox.style.cssText+s;hBox.style.cssText=s1;};this.setOffsetPostion = function(left,top){try{/*if(hBox.style.left)*/{hBox.style.left = left+ "px";hBox.style.top = top+ "px";} } catch(err){return false;generalErrHandler(err,"setOffsetPostion");}  };this.setDonotCloseOnSend = function (i){donotCloseOnSend=i;};this.getItems = function(){return items;};this.getForm = function(){return form;};this.setOkText = function(t){okText=t;};this.setWidth = function(w){hBox.style["width"]=w+"px";};this.setHeight = function(h){hBox.style["height"]=h+"px";};this.ptLabel = function (label,required,mObj,labelRowFlag,labelStyle){var r,c,e;if(label==null)return null;r=f112(hTable);c=f25(r);e=f21("span");c.style.cssText=labelStyle ? labelStyle : styleInputBoxFieldLabel;var b=new Object();b.label=label;if(required){hasRequiredField=1;label=drawStar()+label;} c.appendChild(e);if(mObj){e.style.cssText="cursor: pointer;margin:0px 3px 0px 3px;";e.node=mObj.a;e.onclick=mObj.callBackFn;e.title=mObj.tagTitle;if(mObj.label2!=null)label+=mObj.label2;} f27(e,label);if(labelRowFlag==1)r=f112(hTable);return r;};this.addDateTimePicker=function(label,defaultDate,defaultHour,required,flag,hide)/*flag 0: both date and hour min;1: date only;2;hour min only */ {var r,c,e;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);b.row=r;c=f25(r);if(flag==0){var dd=f21("span");c.appendChild(dd);f27(dd,"date:");c.style.cssText="width:350px;";} if(flag<2){var a=f21("input");a.setAttribute("name",a.id);a.setAttribute("size",10);a.setAttribute("readonly","readonly");if(defaultDate)a.value=defaultDate;form.appendChild(a);b.required=required;b.node=a;items.push(b);c.appendChild(a);var h=f21("span");c.appendChild(h);setupPopupCalendars(a.id);} if(flag==1)/* date only */ return;var hh=f21("span");c.appendChild(hh);f27(hh,"hour:");var ah=f21("select");ah.style.cssText="width: auto;font-size: .9em;padding: 0px 1px 0px 1px;";for(var i=0;i<24;i++){var vh=i;if(i<10)vh="0"+i;addOption(ah,vh,vh);}  form.appendChild(ah);var bh=new Object();bh.required=required;bh.node=ah;bh.row=r;items.push(bh);c.appendChild(ah);var mm=f21("span");c.appendChild(mm);f27(mm,"min:");var bm=new Object();var am=f21("select");am.style.cssText="width: auto;font-size: .9em;padding: 0px 1px 0px 3px;";for(var i=0;i<60;i+=5){var vh=i;if(i<10)vh="0"+i;addOption(am,vh,vh);} form.appendChild(am);bm.node=am;items.push(bm);c.appendChild(am);if(hide==1)b.row.style.display="none";};this.addDatePicker = function(label,defaultDate,size,required){var r,c,e;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);var a=f21("input");a.setAttribute("name",a.id);a.setAttribute("size",10);if(defaultDate)a.value=defaultDate;c=f25(r);form.appendChild(a);b.required=required;b.node=a;items.push(b);c.appendChild(a);var h=f21("span");c.appendChild(h);setupPopupCalendars(a.id);/*new tcal ({'formname': form.id,'controlname': a.id},null,h);*/ return(a.id);};this.f61 = function(label,prompt,size,required,fnValid){var r,c,e;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);var a=f21("input");if(size)a.size=size;if(prompt)a.value=prompt;c=f25(r);form.appendChild(a);b.required=required;b.node=a;b.row=r;items.push(b);c.appendChild(a);if(firstInputField==null)firstInputField=a;if(fnValid!=null)a.onblur=fnValid;return(a.id);};this.doSelectedItem = function (e){var event=window.event || e;var v=getNodeValue(this);if(v!=null && v!=""){this.inputHolder.value=v;this.parentNode.style.display="none";gZform.dropdownList.style.display="none";event.stopPropagation();} else {gZform.dropdownList.style.display="none";} };this.ctDropdownList = function(e){var i,ch;var event=window.event || e;i=event.which ? event.which : event.keyCode;if(i)ch=String.fromCharCode(i);else ch="";var t=this;if(i==8){if(t.value.length>0){t.value=t.value.substr(0,t.value.length-1);t.chs=t.value;} if(t.chs){i=t.chs.length;t.chs=t.chs.substr(0,i-1);} } else if(ch!=""){t.chs+=ch;} var b=filtArray(t.optList,t.chs);var h=f21("div");var holder=f21("div");t.holder.parentNode.replaceChild(h,t.holder);t.holder=h;h.appendChild(holder);holder.style.cssText=stylePopupDropdownListBox;var xh=f21("div");holder.appendChild(xh);f27(xh,"X");xh.style.cssText="cursor: pointer;font-size: 9px;font-weight: 700;text-align: right;color:#DB1435;";xh.onclick=gZform.hideDropdown;xh.setAttribute('title','Click to close this box');for(i=0;i<b.length;i++){var e=f21("div");holder.appendChild(e);f27(e,b[i]);e.onmouseover=f73;e.onmouseout=unHighlightField;e.inputHolder=t.node.node;e.onclick=gZform.doSelectedItem;}  gZform.dropdownList=holder;if(b.length<1)holder.style.display="none";};this.showDropdown = function (){gZform.dropdownList.style.display="";};this.hideDropdown = function (){var v=getNodeValue(this);gZform.dropdownList.style.display="none";};this.addInputSensitiveBox = function(label,defaultv,optionList,size,required){var r,c,e;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);var a=f21("input");if(size)a.size=size;if(defaultv)a.value=defaultv;c=f25(r);form.appendChild(a);b.required=required;b.node=a;b.row=r;b.root=this;items.push(b);c.appendChild(a);var br=f21("br");c.appendChild(br);a.holder=f21("div");c.appendChild(a.holder);if(firstInputField==null)firstInputField=a;a.optList=optionList;a.chs="";a.onkeydown=this.ctDropdownList;a.onfocus=this.ctDropdownList;a.node=b;return(a.id);};this.f106 = function (mObj){var h2;var mu=new f39(mObj.name,0,h2);mu.f70(mObj.addElementCmdName,mObj.callBackFn,mObj.a);mu.init();mObj.name.onmouseover=mu.showMenu;return mu;};this.addList = function(label,prompt,size,required,mObj,id){var r,c,e;var a=f21("span");var a0=f21("span");a.appendChild(a0);mObj.a=a;r=this.ptLabel(label,required,mObj);var b=new Object();b.label=label;if(r==null)r=f112(hTable);c=f25(r);if(mObj.cssText)c.style.cssText=mObj.cssText;form.appendChild(a);b.required=required;b.node=a;b.id=id;items.push(b);c.appendChild(a);if(firstInputField==null)firstInputField=a;return(a0.id);};this.addAvailabilityCheckBox = function(label,opt,size,required,cssText,callBackFn){var r,c,e,f;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);c=f25(r);f27(c,"Name");c=f25(r);f27(c,"Availability");c=f25(r);f27(c,"Personal Preference");var cblist = new Array();for(var i=0;i<opt.length;i++){var q=opt[i];r=f112(hTable);c=f25(r);e=f21("input");e.setAttribute('type','checkbox');e.value=q.id;c.appendChild(e);cblist.push(e);f=f21("span");f27(f,q.name);c.appendChild(f);c=f25(r);f=f21("span");f27(f,q.info);f.style.cssText="width: 200px;padding: 0px 5px 0px 5px;";c.appendChild(f);c=f25(r);f=f21("span");f27(f,q.info2);f.style.cssText="width: 200px;padding: 0px 5px 0px 5px;";c.appendChild(f);} return cblist;};this.addCheckBox = function(label,info,size,required,cssText,callBackFn,checked){var r,c,e,f;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);c=f25(r);var a=f21("input");a.setAttribute('type','checkbox');if(checked==1)a.checked=true;c.appendChild(a);b.required=required;b.node=a;items.push(b);if(callBackFn)a.onchange=callBackFn;if(info){var f=f21("span");c.appendChild(f);f.innerHTML=info;}  return r.id;};this.addRadioButtons = function(label,optionStr,size,required,cssText,callBackFn){var a,r,c,e;r=this.ptLabel(label,required);var data=new Array();var b=new Object();b.label=label;if(r==null)r=f112(hTable);c=f25(r);var opt=optionStr.split(";");for(var i=0;i<opt.length;i++){var p=opt[i];if(p.length>2){a=f21("input");a.setAttribute('type','radio');a.setAttribute('name','var_radio');form.appendChild(a);if(i==0)a.checked=true;var q=p.split(",");e=f21("span");c.appendChild(a);c.appendChild(e);a.setAttribute('value',q[0]);e.innerHTML=q[1];e.style.cssText="margin-right: 25px;";data.push(a);} } b.required=required;b.node=a;b.row=r;items.push(c);c.node=b;c.data=data;if(firstInputField==null)firstInputField=a;if(callBackFn)c.onchange=callBackFn;return(c.id);};this.getCheckedRadioButtonValue = function (c){var data=c.data;var i,e,b;for(i=0;i<data.length;i++){e=data[i];if(e.checked==true){return(e.value);} } return null;};this.addSelectBox = function(label,optionStr,size,required,cssText,callBackFn,selectedOpt){var r,c,e;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);var a=f21("select");a.style.cssText="width: auto;font-size: .9em;padding: 0px 10px 0px 3px;";var opt=optionStr.split(";");for(var i=0;i<opt.length;i++){var p=opt[i];if(p.length>2){var q=p.split(",");addOption(a,q[0],q[1],selectedOpt);} }  c=f25(r);if(cssText)c.style.cssText=cssText;form.appendChild(a);b.required=required;b.node=a;b.row=r;items.push(b);c.appendChild(a);if(firstInputField==null)firstInputField=a;if(callBackFn)a.onchange=callBackFn;r.node=a;return(r.id);};this.addCheckBoxList = function(label,optionStr,size,required,cssText,callBackFn,labelRowFlag,labelStyle){var r,c,e;r=this.ptLabel(label,required,null,labelRowFlag,labelStyle);var b=new Object();b.label=label;if(r==null)r=f112(hTable);c=f25(r);if(cssText)c.style.cssText=cssText;var opt=optionStr.split(";");for(var i=0;i<opt.length;i++){var p=opt[i];if(p.length>2){var q=p.split(",");var f=f21("div");c.appendChild(f);var a=f21("input");f.appendChild(a);a.setAttribute('type','checkbox');var g=f21("scan");f.appendChild(g);g.innerHTML=q[1];a.uid=q[0];if(callBackFn)a.onchange=callBackFn;} }   if(firstInputField==null)firstInputField=a;return(r.id);};this.addSelectTimeBox = function(label,hide,required,cssText){var r,c,e;r=this.ptLabel(label,required);var b=new Object();b.label=label;if(r==null)r=f112(hTable);var a=f21("select");a.style.cssText="width: auto;font-size: .9em;padding: 0px 1px 0px 1px;";for(var i=0;i<24;i++){var vh=i;if(i<10)vh="0"+i;addOption(a,vh,vh);}  c=f25(r);if(cssText)c.style.cssText=cssText;var hh=f21("span");c.appendChild(hh);f27(hh,"hour:");form.appendChild(a);b.required=required;b.node=a;b.row=r;items.push(b);c.appendChild(a);var mm=f21("span");c.appendChild(mm);f27(mm,"min:");var b2=new Object();var a2=f21("select");a2.style.cssText="width: auto;font-size: .9em;padding: 0px 1px 0px 3px;";for(var i=0;i<60;i+=5){var vh=i;if(i<10)vh="0"+i;addOption(a2,vh,vh);} form.appendChild(a2);b2.node=a2;items.push(b2);c.appendChild(a2);if(hide==1)b.row.style.display="none";return(a.id);};this.addFilePrompt = function(label,size,note){var a,r,c,e;r=f112(hTable);var d=f21("rhead");c=f21("td");e=f21("span");r.appendChild(c);c.appendChild(d);d.appendChild(e);f27(e,label);var a=f21("input");a.type="file";if(size)a.size=size;c=f25(r);form.appendChild(a);c.appendChild(a);if(firstInputField==null)firstInputField=a;if(note){var d=f21("footnote");e=f21("div");hBox.appendChild(d);d.appendChild(e);f27(e,note);} return(a.id);};this.addTextarea = function(label,text,width,height,labelRowFlag){var r,c,e,w,h;r=this.ptLabel(label,null,null,labelRowFlag,null);if(r==null)r=f112(hTable);w=width ? width : 60;h=height ? height : 8;c=f25(r);e=f21("textarea");e.style.cssText=styleNormalText;e.setAttribute("rows",h);e.setAttribute("cols",w);if(text)f27(e,text);firstInputField=e;c.appendChild(e);okText="Update";cancelText="Close Without Update";items.push(e);return (e.id);};this.init = function(){var c,e;cancelCallbackFn=null;if(frmStyleClass){var z=f21(frmStyleClass);handle.appendChild(z);z.appendChild(hBox);} else {handle.appendChild(hBox);} handle.hBox=hBox;if(title!=null){var ti=f21("htitle");var e=f21("span");hBox.appendChild(ti);ti.appendChild(e);e.style.cssText=styleInputBoxFieldLabel;f27(e,title);} if(info!=null){var e=f21("div");e.style.cssText=styleNormalText;f27(e,info);hBox.appendChild(e);} hBox.appendChild(hTable);var z=hBox;form.setAttribute("method","POST");b=f21("span");b.style.cssText="align:center;";if(ptOkButton==1){c=f21("input");c.setAttribute("type","button");c.setAttribute("value",okText);c.onclick=this.sendForm;c.style.cssText=styleButtonText;b.appendChild(c);}  if(ptCancelButton==1){c=f21("input");c.setAttribute("type","button");c.style.cssText=styleButtonText;c.setAttribute("value",cancelText);c.onclick=this.close;b.appendChild(c);}  hBox.appendChild(b);if(hasRequiredField==1){b=f21("div");var s=drawStar()+" Required value.";f27(b,s);hBox.appendChild(b);}  hBox.style.display = "";};this.setFocusField = function(){firstInputField.focus();};this.showForm = function(){hBox.style.display = "";return false;};this.setCancelCallback = function(f){cancelCallbackFn=f;};this.close = function(e){if(cancelCallbackFn){cancelCallbackFn(e);return;} try{var p;if (!e)var e = window.event;hBox.style.display = "none";p=node;if(node.node==null)/* for editCmt */ {p=node.owner;if(p)p.form=null;} else node.node.form=null;if(!e)return false;if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;}  catch(err){generalErrHandler(err,"f72.close");} return false;};this.sendForm = function(){var a,v,i,n;n=items.length;for(i=0;i<n;i++){a=items[i];if(a.required==1){v=a.node.value;if(!v || v.length<1){var s=a.label+" field cannot be empty.";alert(s);return;} } } if(donotCloseOnSend==0)hBox.style.display = "none";callBackFn(form,items,node);};this.f71 = function(fn){callBackFn=fn;};};function addOption (sel,value,text,selectedOpt){var optn = document.createElement("OPTION");optn.text = text;optn.value = value;if(value==selectedOpt)optn.selected=true;sel.options.add(optn);};function ctSelectBox (label,optionStr,size,required,cssText,callBackFn,selectedOpt){var r,c,e;var h=f21("span");var lab=f21("span");h.appendChild(lab);lab.innerHTML=label;var b=new Object();h.node=b;var a=f21("select");h.appendChild(a);a.style.cssText="width: auto;font-size: .9em;padding: 0px 10px 0px 3px;";var opt=optionStr.split(";");for(var i=0;i<opt.length;i++){var p=opt[i];if(p.length>2){var q=p.split(",");addOption(a,q[0],q[1],selectedOpt);} } b.sel=a;if(callBackFn)a.onchange=callBackFn;return(h);};function addOption (sel,value,text,selectedOpt){var optn = document.createElement("OPTION");optn.text = text;optn.value = value;if(optn.value==selectedOpt)optn.selected=true;sel.options.add(optn);};function ctDropdownList(valStr,labStr,callBackFn){var h=f21("div");var holder=f21("div");h.holder=holder;h.appendChild(holder);holder.style.cssText="position:absolute;z-index:1900;border-width: 1px 1px 1px 1px;border-style: solid;border-color: #7A5D48;";var xh=f21("div");holder.appendChild(xh);xh.h=h;f27(xh,"X");xh.style.cssText="cursor: pointer;font-size: 9px;font-weight: 700;text-align: left;color:#DB1435;background-color:white;";xh.onclick=hideDropdownList;xh.setAttribute('title','Click to close this box');var sty="background-color: white;font-family: Verdana,Arial,'Microsoft Sans Serif';font-size:9px;border-width: 0px 0px 0px 0px;border-style: solid;border-color: #1C1618;";for(var i=0;i<labStr.length;i++){var e=f21("div");e.style.cssText=sty;holder.appendChild(e);f27(e,labStr[i]);e.onmouseover=f73;e.onmouseout=unHighlightField;/*e.inputHolder=t.node.node;*/e.onclick=callBackFn;e.holder=holder;e.label=labStr[i];e.h=h;} return h;};function hideDropdownList (){var h;h=this.h;h.holder.style.display="none";h.holder.flag=0;};function ctTextArea (callback,r,c,text){var e;e=f21("textarea");e.style.cssText=styleNormalText;e.setAttribute("rows",r);e.setAttribute("cols",c);e.onblur=callback;if(text)f27(e,text);return e;};function ctRadioButton(callBackFn,name,label,val){var a,b,c;if(!name)name="var_radio";if(IE){/*b="<input name="+name+">";a=document.createElement(b);*/ a=f21("input");} else {a=f21("input");a.setAttribute('name',name);} a.type="radio";c=f21("span");c.appendChild(a);if(val)a.setAttribute('val',val);if(label){b=f21("span");c.appendChild(b);b.innerHTML=label;} if(callBackFn)a.onclick=callBackFn;c.node=a;return c;};function ctEditableSpan(callbackFn,prompt,cssText){var c=f21("span");c.setAttribute("contentEditable","true");c.innerHTML=prompt;c.onblur=callbackFn;if(cssText)c.style.cssText=cssText;return c;};/* zUtilities.js */ var IE = document.all?true:false;var g_objId;g_objId=1;var ellipsis="...";var gMenu = new Array();function browserType(){var s,ffversion;s=navigator.userAgent;if (/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){/*test for Firefox/x.x or Firefox x.x (ignoring remaining digits);*/  ffversion=new Number(RegExp.$1);/* capture x.x portion and store as a number */  if (ffversion>=3)s="FF3";else if(ffversion>=2)s="FF2";else s="FF1";return s;} if (/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent)){s="Chrome";return s;} else if (/MSIE[\/\s](\d+\.\d+)/.test(navigator.userAgent)){s="MSIE";return s;} return s;};function f118(){return g_objId++;};function f111(t){t.setAttribute("id",f118());};function f21(type,id){if(id==null)id=f118();var t = document.createElement(type);t.setAttribute("id",id);return t;};function f22(t){var newRow=t.insertRow(-1);var newCell=newRow.insertCell(-1);return newCell;};function f112(table){var i=table.rows.length;var newRow=f21("tr");newRow.setAttribute("index",i);table.appendChild(newRow);return newRow;};function drawStar(){var s="<span style=\"color: #C22B3D;\">*</span>";return s;};function f25(row,w){var newCell=row.insertCell(-1);if(w)newCell.style.width=w+'px';var id=f118();newCell.setAttribute("id",id);/*newCell.style.border="1px solid black";newCell.style.borderWidth="1px 0px 0px 1px";*/ newCell.style.verticalAlign="text-top";/*newCell.style.verticalAlign="text-bottom";*/ return newCell;};function f78 (top,right,bottom,left){top=top?top:0;right=right?right:0;bottom=bottom?bottom:0;left=left?left:0;var a="border-style: solid;border-color: black;border-width:";var b=top+"px "+right+"px "+bottom+"px "+left+"px;";return a+b;};function f17(row,n,lastRow,noBorder,drawVerticalBar){var i,t,w;var bg;if(drawVerticalBar==1){if(IE)bg=bgVerticalBarIE;else bg=bgVerticalBar;} else  bg="";for(i=0;i<n;i++){var c=f25(row,20);w=c.style.width;if(noBorder!=null)t="width:"+w+";"+f78(0,0,0,0);else /*t="width:"+w+";"+f78(1,0,lastRow,1);*/ t="width:"+w+";"+f78(0,0,0,0);c.style.cssText=t+bg;f27(c,"&nbsp;");} };function f18(cell,t){cell.style.fontWeight="bold";f27(cell,t);};function ctTextCell(r,t,sty,border){var c=f25(r,25);c.style.cssText=sty+border;f27(c,t);return c;};function println(t,div,sty,border){var c=f21("div");div.appendChild(c);c.style.cssText=sty+border;f27(c,t);return c;};/*  function f27(cel,val){var t,v;if(cel.tagName=="div" || cel.tagName=="DIV")v=f21("div");else if(cel.tagName=="span" || cel.tagName=="SPAN")v=f21("span");else if(cel.tagName=="td" || cel.tagName=="TD")v=f21("td");else alert("something else");if(val==undefined)t="&nbsp;";else t=val;v.innerHTML = t;if(cel.parentNode!=undefined)cel.parentNode.replaceChild(v,cel);else cel.innerHTML=t; };*/ function f27(cel,val){var t,v;if(cel==undefined){var s="in f27,not defined cell,"+val;alert(s);return;}  if(val==undefined)t="&nbsp;";else t=val;cel.innerHTML = t; };function showVal(val1,val2,val3){var z=document.getElementById("workBox");var t=val1+','+val2+','+val3;if(z!=null)z.innerHTML=t;};function getNodeValue(c){if(c==null)return null;if(c.innerText)return c.innerText;else return c.textContent;};function findStrOffsetWidth(str){var h = f21("span");h.innerHTML=str;h.style.visibility = 'hidden';document.body.appendChild(h);var w=h.offsetWidth;document.body.removeChild(h);return w;};function reformatText(text,width,temp){if(text==null)return null;var m=findStrOffsetWidth(text);if(m<width-2)return text;var i=parseFloat(width)/10;return text.substr(0,i)+ ellipsis;/* //var temp=f21("span");//temp.style.cssText = cssText;//temp.style.visibility = "hidden";//temp.style.position = "absolute";//return text.substr(0,i-1)+ ellipsis;//   t=text.substr(0,i)+ ellipsis;//j=temp.offsetHeight;*/  j=3;while(j<30 && i<text.length){t=text.substr(0,i)+ ellipsis;temp.innerText= t;j=temp.offsetHeight;i+=1;} showVal(i,j,t);return text.substr(0,i-1)+ ellipsis;};function ctClickableButton(a,actionFn,imgvar,tagTitle){var u,t;u="<a href=\"\" title=\""+tagTitle+"\">";t=f21("span");f27(t,u+imgvar+"</a>&nbsp;");t.node=a;t.root=this;t.onclick= actionFn;return t;};function disableRightClick(){document.oncontextmenu = handleRighClick;};function handleRighClick(){return false;};function f29(){this.data = new Array();this.push =function(v){this.data.push(v);};this.pop = function(){return this.data.pop();};this.printf29 = function(){return this.data;};this.getAt = function(i){if(this.isEmpty())return null;return(this.data[i]);};this.isEmpty = function(){if(this.data.length<1)return true;else return false;};this.getSize = function(){return this.data.length;};};/* whitespace characters*/       var whitespace = " \t\n\r";function isEmpty(s){return ((s == null)|| (s.length == 0));};function isWhitespace(s){return !/[^\s]/.test(s);/*           var i;if (isEmpty(s))return true;for (i = 0;i < s.length;i++){var c = s.charAt(i);if (whitespace.indexOf(c)== -1)return false;}            return true;*/       };/* Array Remove - By John Resig (MIT Licensed)*/ Array.prototype.remove = function(from,to){var rest = this.slice((to || from)+ 1 || this.length);this.length = from < 0 ? this.length + from : from;return this.push.apply(this,rest);};function keyVal(key,val){this.key=key;this.val=val;this.cnt=1;return this;};function f30(){var data = new Array();this.load = function(s,c1,c2){var a,b,i;a=s.split(c1);for(i=0;i<a.length;i++){b=a[i].split(c2);if(b.length>1){this.add(b[0],b[1]);} } };this.add = function(key,val){var a=new keyVal(key,val);data.push(a);var t=a.val;};this.getAt = function(i){return data[i];};this.getAt = function(i){return data[i];};this.get = function(key){var i,n;n=data.length;for(i=0;i<n;i++){var a=data[i];if(a.key==key){a.index=i;return a;} } return null;};this.getIgnorCase = function(key){var i,n;n=data.length;for(i=0;i<n;i++){var a=data[i];if(a.key.toLowerCase()==key.toLowerCase()){a.index=i;return a;} } return null;};this.getIndexOf = function(key){var i,n;n=data.length;for(i=0;i<n;i++){var a=data[i];if(a.key==key){return i;} } return null;};this.getVal=function(key){var a=this.get(key);if(a)return a.val;else return null;};this.remove = function(key){var i;var a=this.get(key);if(a!=null){i=a.index;data.remove(i);} i=data.length;i=2;};this.update = function(key,val){var a=this.get(key);if(a){a.val=val;} else this.add(key,val);};this.updateIgnoreCase = function(key,val){var a=this.getIgnorCase(key);if(a){a.val=val;} else this.add(key,val);};this.aggregate = function(key,val,predecessorKey){var i;var a=this.get(key);if(a){a.val=val;a.cnt+=1;return;} if(predecessorKey==null){this.add(key,val);return;} i=this.getIndexOf(predecessorKey);this.insertAt(key,val,i+1);};this.insertAt = function(key,val,i){var a=new keyVal(key,val);data.splice(i,0,a);};this.getSize = function(){return data.length;};this.pop = function(){return data.pop();};this.write = function(){var i,n;n=data.length;for(i=0;i<n;i++){var a=data[i];document.write(a.key + "<br />");} };this.toString= function(){var i,n,s;n=data.length;s="";for(i=0;i<n;i++){var a=data[i];s+=a.key+":"+a.val+";";} return s;};};function f38(holder,label,callBackFn,img){var m,u;if(holder==null)return;var imgF=img ? img : "";m=f21("span");u="<a href=\"\">"+imgF+label+"</a>";m.style.cssText=styleMenuItem;m.onclick=callBackFn;f27(m,u);holder.appendChild(m);return m;};function menuBar(h){var handle=h;var holder=f21("span");holder.style.cssText="vertical-align:bottom;";handle.appendChild(holder);this.f70 = function(label,img,callBackFn,obj){var c,t,s;s="&nbsp;&nbsp;&nbsp;";var u="<a href=\"\">";t=s+u+img+"</a>";c=f21("span");if(obj)c.obj=obj;f27(c,t);c.onclick=callBackFn;/*c.onmouseover=this.onMouseOver;c.onmouseout=this.onMouseOut;*/holder.appendChild(c);} };function donothing(){return false;};function f37(node){if (typeof(XMLSerializer)!== 'undefined'){var serializer = new XMLSerializer();return serializer.serializeToString(node);} else if (node.xml){return node.xml;} };function popupBoxG(handle,d){var h,r,c,c0,c1;var holder=f21("span");handle.appendChild(holder);var m=f21("div");holder.appendChild(m);holder.appendChild(d);holder.style.cssText=stylePopupBox;holder.style.display="";m.style.cssText="background-color:#4C779C;text-align:right;";m.handle=holder;var b=ctInputButton(closePopupBox," X ","Click here to close this box","blueRedButton");b.handle=holder;m.appendChild(b);};function popupBox(e,handle,t,noXMP){var h,r,c,c0,c1;var holder=f21("span");handle.appendChild(holder);var m=f21("div");holder.appendChild(m);var c0=f21("div");holder.appendChild(c0);holder.style.cssText=stylePopupBox;c0.style.cssText=stylePopupBoxText;if(IE){c0.style.cssText=stylePopupBoxTextIe;} if(t.length>500){holder.style.cssText+="width:390px;height:360px;";c0.style.cssText+="width:390px;height:335px;";} else if (t.length>300){holder.style.cssText+="width:380px;height:200px;";c0.style.cssText+="width:378px;height:175px;";} else  {holder.style.cssText+="width:250px;height:120px;";c0.style.cssText+="width:248px;height:105px;";}  holder.style.display="";m.style.cssText="background-color:#4C779C;text-align:right;";m.handle=holder;var b=ctInputButton(closePopupBox," X ","Click here to close this box","blueRedButton");b.handle=holder;m.appendChild(b);if(noXMP==1){c0.innerHTML=t;return;} c1=f21("XMP");c0.appendChild(c1);if(IE){c0.style.cssText=stylePopupBoxTextIe+"width:380px;height:183px;";c1.innerText=t;} else c1.textContent=t;return false;};function popupBoxResiable(e,handle,t){var h,r,c,c0,c1;var g=new f55("table0","Html Table");var holder=f21("span");handle.appendChild(holder);h=f21("table");h.style.cssText=stylePopupBox;r=f112(h);var resizableTd=g.f56(0,0,h);r.appendChild(resizableTd);c=resizableTd.contentHolder;c.handle=holder;c.innerHTML="<a href='#'>Close</a>";c.onclick=closePopupBox;r=f112(h);c=f25(r);c0=f21("div");c1=f21("pre");if(IE)c1.innerText=t;else c1.textContent=t;c.appendChild(c0);c0.appendChild(c1);var w=h.style.width ? h.style.width : "400px";h.widthv=parseInt(w.substring(0,w.length-2));holder.appendChild(h);};function popupBoxH(e,handle,t,cssText){var h,r,c,c0,c1;var holder;var h0=f21("span");handle.appendChild(h0);h0.style.cssText=cssText || stylePopupBox;c=f21("span");c.handle=h0;c.innerHTML="<a href='#'>Close</a>";c.onclick=closePopupBox;c0=f21("div");c1=f21("pre");if(IE)c1.innerText=t;else c1.textContent=t;c.appendChild(c0);c0.appendChild(c1);h0.appendChild(c);holder=f21("span");h0.appendChild(holder);holder.style.display ="";this.getHolder = function(){return holder;};this.setOffsetPostion = function(left,top){h0.style.left = left+ "px";h0.style.top = top+ "px";};};function closePopupBox(e){e = (e)? e : window.event;if (IE)window.event.cancelBubble = true;else  e.stopPropagation();var a=this.parentElement ? this.parentElement : this.parentNode;this.handle.style.display="none";return false;};function f36(h){var g=new f55("table1","Html Table");g.f56(0,0,h);};function popupWindow(url,winTitle,options,pos){var x,y;if(options==null)options="";w= window.open (url,winTitle,options);w.focus();return w;};function findPos(obj){var p;var curleft = curtop = 0;while (obj && obj.offsetLeft!=null && obj.offsetTop!=null){curleft += obj.offsetLeft;curtop += obj.offsetTop;obj=obj.parentElement ? obj.parentElement : obj.parentNode;} return [curleft,curtop];};function getPath(e,owner){var found=0;var i,t,ind;if (e===document.body)return e.tagName;if(!e)return "";if(e.nodeType==9)return "";if(e.nodeType==2){/* return getPath(e.ownerElement)+"@"+e.nodeName;*/ return getPath(owner.ptr)+"@"+e.nodeName;}       var k=0;var sibs= e.parentNode.childNodes;for (i=0;i<sibs.length;i++){var sib= sibs[i];if (sib===e){ind=k;found=1;}             if (sib.nodeType===1 && sib.tagName===e.tagName)k++;}       if(found==1){if(k>1)t='['+(ind+1)+']';else                   t="";return getPath(e.parentNode)+'/'+e.tagName+t;} };function f62(row,styl){var i,n,c,b,ty,myrow;if(row!=null && row.cells!=null)myrow=row;else myrow=this;if(styl!=null)ty=styl;else ty=styleHighlightBkColor;var cells=myrow.cells;if(cells==null)return;n=cells.length;for(i=0;i<n;i++){c=cells[i];b=c.style["backgroundColor"];if(c.savedStyle==null)c.savedStyle=c.style.cssText;c.style["backgroundColor"]=ty;} return false;};function f63(row){var i,n,c,b,ty;var myrow=this;var cells=myrow.cells;if(cells==null)cells=row.childNodes;if(cells==null)return;for(i=0;i<cells.length;i++){c=cells[i];b=c.style["backgroundColor"];c.style.cssText=c.savedStyle;c.savedStyle=null;}  return false;};function hideme(){this.style.display="none";};function showme(){this.style.display="";};function hide(id){var t=document.getElementById(id);t.style.display="none";};function show(id){var t=document.getElementById(id);t.style.display="";};function f315(id){var t=document.getElementById(id);if(t.style.display=="")t.style.display="none";else t.style.display="";};function f315Div(id,v){var h=document.getElementById(id);f315H(h,v);};function f315H(h,v){var c;c=h.style.cssText;if(v==1)h.style.cssText=updateCssText(h.style.cssText,"display","");else h.style.cssText=updateCssText(h.style.cssText,"display","none");};function clearBox(id){var h=document.getElementById(id);if(h)h.innerHTML="";};function updateCssText(t,key,val){var a,b,c,i;a=t.split(";");for(i=0;i<a.length;i++){b=a[i].split(":");if(b[0]==key){b[1]=val;c=b.join(":");a[i]=c;} } c=a.join(";");return c; };function f73(){this.bgcSave=this.style["backgroundColor"];this.style["backgroundColor"]=styleHighlightBkColor;};function unHighlightField(){this.style["backgroundColor"]=this.bgcSave;};function changeRowStyle(r,textDecoration){var i,n,c,b;n=r.childNodes.length;for(i=0;i<n;i++){c=r.childNodes[i].firstChild;c.style.cssText=textDecoration;}  return false;};function encodeToHex(str){var r="";var e=str.length;var c=0;var h;while(c<e){h=str.charCodeAt(c++).toString(16);if(h.length<2)h="0"+h;r+=h.toUpperCase();}     return r;};function removeRow(tb,id){var i,n,myid;var rows = tb.getElementsByTagName('tr');n=eval(rows.length);for(i=0;i<n;i++){var myRow=rows[i];myid=myRow.getAttribute("id");if(myid==id){tb.deleteRow(i);return false;} }  };function createSubmitForm(frmName){var submitForm = document.createElement("form");submitForm.setAttribute("name",frmName);document.body.appendChild(submitForm);submitForm.method = "POST";return submitForm;};function f201(f,elementName,elementValue){var a = f21("input");a.setAttribute("name",elementName);a.setAttribute("type","hidden");f.appendChild(a);a.value=elementValue;return a;};function leftTrim(str){while (str.substring(0,1)== ' ' ||  str.substring(0,1)=='\n' || str.substring(0,1)=='\t' ){str = str.substring(1,str.length);} return str;};function rightTrim(str){while (str.substring(str.length-1,str.length)== ' ' || str.substring(str.length-1,str.length)== '\n' || str.substring(str.length-1,str.length)== '\t'){str = str.substring(0,str.length-1);} return str;};function filtArray(a,key){var b = new Array();var i,c,d;var m=key.length;key=key.toLowerCase();for(i=0;i<a.length;i++){c=a[i];d=c.substring(0,m);if(d.toLowerCase()==key)b.push(c);} return b;};function strToFilteredArray (str,key){var a=str.split(",");var b=filtArray(a,key);return b;};function changeCmdIconImg(){var a=this.node;if(a && a.img0){this.innerHTML=a.img0;} };function changeCmdIconImg0(){var a=this.node;if(a && a.img){this.innerHTML=a.img;} };function ctCmdIcon(callBackFn,img,info,node,sty){var h=f21("span");h.style.cssText="cursor: pointer;margin:0px 3px 0px 3px;";if(sty)h.style.cssText+=sty;if(img)h.innerHTML=img;else h.innerHTML=info;h.onmouseover=changeCmdIconImg;h.onmouseout=changeCmdIconImg0;h.onclick=callBackFn;h.node=node;h.setAttribute('title',info);return h;};function ctInputButton(callBackFn,label,info,styClass){var c=f21("input");c.setAttribute("type","button");c.setAttribute("value",label);c.setAttribute('title',info);c.onclick=callBackFn;if(styClass)c.setAttribute("class",styClass);else c.style.cssText=styleButtonText;c.style.cssText+="cursor: pointer;";return c;};function ctCssButton(callBackFn,label,info){var c=f21("span");c.innerHTML=label;c.setAttribute("class","cssbuttonRed");c.onclick=callBackFn;c.style.cssText=styleButtonText;return c;};function ctCmdButton(callBackFn,str,info,node,border,cssText,styClass){var t="";var h=f21("span");if(border)t="border-style: solid;border-color: black;border-width: 1px 2px 1px 1px;";h.style.cssText=t+"cursor: pointer;margin:0px 3px 0px 3px;padding: 0px 3px 0px 3px";if(cssText!=null)h.style.cssText=cssText;h.innerHTML=str;h.onclick=callBackFn;h.node=node;h.setAttribute('title',info);if(styClass)h.setAttribute("class",styClass);return h;};function generalErrHandler(err,fn){var s,ss;ss="";for (var i in err)ss+="\n"+err[i];/*s="Error in "+fn+"\n"+err.line+"\n"+err.description+ss;*/ s="Error in "+fn+"\n"+ss;alert(s);return false;};function zGetDayOfMonth(date){var a=date.split("-");var b=a[2];return parseInt(b,10);};function cssText(s){var data=new f30();var i,t,c;var a=s.split(";");for(i=0;i<a.length;i++){c=a[i];if(c.length>5){var b=c.split(":");data.add(leftTrim(b[0]),b[1]);} } i=data.getSize();this.toString = function(){return data.toString();};this.update = function (key,val){data.updateIgnoreCase(key,val);}; };function updateCssText(cssStr,key,val){var x=new cssText(cssStr);x.update(key,val);var w=x.toString();return w;};function getDateTimeStr(){var yy;var now=new Date();var mm=now.getMonth()+1;if(mm<10)mm="0"+mm;var dd=now.getDate();if(dd<10)dd="0"+dd;yy=now.getYear();if(!IE)yy=yy+1900;var dstr=yy+"/"+mm+"/"+dd+" "+now.getHours()+":"+now.getMinutes()+":"+now.getSeconds()+"";return dstr;};function displayImgThumb(c,src,height){var ht;ht=height ? height : 50;var c1=f21("div");var c3=f21("img");c.appendChild(c1);c1.appendChild(c3);c3.setAttribute('src',src);c3.setAttribute('height',ht);c3.onmouseover=chageCursorToPointer;c3.onclick = expandImg;c3.src=src;};function chageCursorToPointer(){this.style.cursor="pointer";};function expandImg(){var src=this.src;var opt="height=320,width=500";popupWindow(src,"",opt);};function validateNodeName(s,doc){var e,t,v;v=s.substring(0,3).toLowerCase();if(v=="xml"){alert("Node name cannot start with 'xml'");return false;} try{e=doc.createElement(s);/*e.myNodeName=v;*/return e;} catch(err){alert(s+" contains illegal characters for a node name.");return false;}  };function validateStr(n,s,doc){var r,re;var re_validAttrName = new RegExp("^[a-zA-Z_:][-a-zA-Z0-9_:.]*$");if(n=="Attribute Name")re=re_validAttrName;else if (n=="Node Name"){return(validateNodeName(s,doc));} r=re.test(s);if(r==true)return true;alert(s+" contains illegal characters for "+n);return false;};function xmlToStr(a){var i,n;n=a.childNodes.length;return;};function csvToArray(strData,strDelimiter ){strDelimiter = (strDelimiter || ",");var objPattern = new RegExp((/* Delimiters. */ "(\\" + strDelimiter + "|\\r?\\n|\\r|^)" + /* Quoted fields */ "(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" + /* Standard fields */ "([^\"\\" + strDelimiter + "\\r\\n]*))" ),"gi");var arrData = [[]];var arrMatches = null;while (arrMatches = objPattern.exec(strData )){var strMatchedDelimiter = arrMatches[1];if (strMatchedDelimiter.length && (strMatchedDelimiter != strDelimiter)){/* Since we have reached a new row of data,add an empty row to our data array */ arrData.push([]);}  /* Now that we have our v5 out of the way,check to see which kind of value we captured (quoted or unquoted)*/ if (arrMatches[2]){/* We found a quoted value. When we capture this value,unescape any double quotes */  var strMatchedValue = arrMatches[2].replace(new RegExp("\"\"","g"),"\"");}  else  {/* We found a non-quoted value */ var strMatchedValue = arrMatches[3];}   /* Now that we have our value string,add it to the data array */ arrData[arrData.length - 1].push(strMatchedValue);} return arrData;};function dateConvert(s,i){var a,t,c,im,id;var d,m,y,mm,dd;if(s.indexOf('-')>0)c='-';else if(s.indexOf('/')>0)c="/";else return s;a=s.split(c);if(i==1){im=0;id=1;} else if(i==2){im=1;id=0;} mm=a[im]*1;dd=a[id]*1;if(mm<10)m="0"+ mm;else m=mm;if(dd<10)d="0"+dd;else d=dd;t=a[2]+"-"+m+"-"+d;return t;};function launchUrl(url,opt){if (opt == 0)/* current window */     window.location = url;else if (opt == 1)/* new window */     window.open(url);else if (opt == 2)/* background window */     {window.open(url);self.focus();} };function f313(a){var b;if(!a)return null;b=a.firstChild;if(b)return b.data;return null;};function f316(text){return !/[^\s]/.test(text);};function determineDataType(s){var r;if(isDatetime(s))return "xs:dateTime";if(isDate(s))return "xs:date";if(isInt(s))return "xs:int";if(isNumber(s))return "xs:double";return "xs:string";};function isDate(s){var pattern = new RegExp("^([0-9]{4})-([0-1][0-9])-([0-3][0-9])$");if(s.match(pattern))return true;else return false;};function isInt(s){if (s != null && s != "" && !isNaN(s)){return (parseInt(s,10)== s);}     return false;};function isNumber(s){return !isNaN(parseFloat(s))&& isFinite(s);};function isDatetime(s){if(!s || s=="")return false;var re0 = new RegExp("^([0-9]{4})-([0-1][0-9])-([0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9]-[0-9][0-9]:[0-9][0-9])$");var re1 = new RegExp("^([0-9]{4})-([0-1][0-9])-([0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9]\\+[0-9][0-9]:[0-9][0-9])$");var re =  new RegExp("^([0-9]{4})-([0-1][0-9])-([0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](Z)?)$");if(s.match(re0))return true;/* 2012-05-04T01:15:52-00:00 */ else if(s.match(re1))return true;/* 2012-05-04T01:15:52+00:00 */ else if(s.match(re))return true;/* 2012-05-04T01:15:52Z */ else  return false;};function wait(msecs){var start = new Date().getTime();var cur = start;while(cur - start < msecs){cur = new Date().getTime();} };function setCookie(name,value,days){if (days){var date = new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires = ";expires="+date.toGMTString();} else var expires = "";document.cookie = name+"="+escape(value)+expires+";path=/";};function getCookie(c_name){var i,x,y;var a=document.cookie.split(";");for (i=0;i<a.length;i++){x=a[i].substr(0,a[i].indexOf("="));y=a[i].substr(a[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if (x==c_name){return unescape(y);}   } };/* end of file */                function f39(h,w,h2){var menuTable;var handle;var handle2;var holder=f21("span");var showStatus;menuTable=f21("table");menuTable.style.cssText=stylePopupMenu; if(w){menuTable.style.width=w+"px";} holder.appendChild(menuTable);if(h2!=null){handle=h2;h2.appendChild(holder);} else {handle=h;handle.appendChild(holder);}  this.getMenuTable = function(){return menuTable;};this.getHolder = function(){return holder;};this.setHandle2 = function(h){handle2=h;};this.init = function(){var r,c;showStatus=1;menuTable.style.display = "none";menuTable.onmouseover=this.showMe;holder.onclick=this.hideMenu;this.f70 ("Cancel",this.hideMenu);/* menuTable.onmouseout=this.hideMenu;menuTable.onmouseout=this.preCloseMenu;document.onclick=this.onclick;if (document.captureEvents)document.captureEvents(Event.CLICK);gMenu.push(menuTable);*/  };this.f70 = function(label,callBackFn,node,ctSubMenuFn){var c,r;r=f112(menuTable);c=f25(r);c.style.cssText=styleMenuItem;f27(c,label);c.onmouseover=this.onMouseOver;c.onmouseout=this.onMouseOut;if(callBackFn)c.onclick=callBackFn;c.node=node;c.menuHandle=handle;if(ctSubMenuFn!=null){var c1=f25(r,2);f27(c1,imgRtTriangle);c1.onmouseover=this.onMouseOver;c1.onmouseout=this.onMouseOut;c1.root=handle.root;c1.node=node;ctSubMenuFn(c1);} else {c.colSpan=2;} return c;};this.onMouseOver = function(){this.style.backgroundColor="#2FEFEF";if(this.subMenu){var t=this.subMenu;t.showSubMenu(this);} };this.onMouseOut = function(){this.style.backgroundColor="#FFFFFF";if(this.subMenu){var t=this.subMenu;/*t.hideMenu();*/ } };this.showMe = function(){if(showStatus==0)return false;menuTable.style.display = "";showStatus=0;return false;};this.hideMenu = function(event){var t=this;if(showStatus)var w=showStatus;menuTable.style.display = "none";showStatus=0;/* event.returnValue=false;*/ return false;};this.showSubMenu = function(c){var e=c;var i;var p=findPos(c);i=eval(p[0]);i=menuTable.offsetLeft;menuTable.style.offsetleft = 180+"px";menuTable.style.display = "";showStatus=1;return false;};this.showMenu = function(e){var t=this;var ev=e;/* var mode=v1.mode;if(mode==2)return false;*/   if (!IE){holder.style.left = e.clientX+document.body.scrollLeft;holder.style.top = e.clientY+document.body.scrollTop;} else    {holder.style.pixelLeft = event.clientX+document.body.scrollLeft;holder.style.pixelTop = event.clientY+document.body.scrollTop;}  menuTable.style.display = "";return false;};};/* datasource.js */ var rowName="r";var colName="c";var g_requestFlag;var g_saveDocMode=1;/* var g_mainScript=0;these variables will be reset in server g_mainScript=0;g_saveDocMode=0;*/  function dataSource(){this.data = new Array();this.headerInfo = new Array();this.maxNumOfElemInRow=0;this.f103 = function(arr){this.data.push(arr);if(arr.length>this.maxNumOfElemInRow)this.maxNumOfElemInRow=arr.length;};this.loadFromHtmlTable = function(hTable,aRowIndx){var r,i,j,m,n;var ai=aRowIndx ? aRowIndx : 0;var rows=hTable.getElementsByTagName("tr");hTable.widthv=15;n=rows.length;for(i=1;i<n;i++){r=rows[i].getElementsByTagName("td");m=r.length;var newRow= new Array();for(j=0;j<m;j++){var c=r[j];var t=c.textContent ? c.textContent :c.innerText;newRow.push(t);} this.data.push(newRow);} r=rows[ai].getElementsByTagName("td");m=r.length;for(j=0;j<m;j++){var c=r[j];var cssStyleStr=c.getAttribute('style');var t=c.textContent ? c.textContent :c.innerText;var w=eval(c.clientWidth);var w1=eval(c.offsetWidth);var col=new colInfo(t,w1,j);this.headerInfo.push(col);hTable.widthv+=w1;} };this.loadFromXmlString=function(xstr){var parser = new f59();parser.f119(xstr);var xmlDoc=parser.getDoc();var rows=xmlDoc.getElementsByTagName(rowName);var n=eval(rows.length);var m,aa;for(var i=0;i<n;i++){var r=rows[i];var newRow= new Array();var atts=r.attributes;var a=atts[0];if(a){aa=a.nodeValue;} else {/*aa=r.getAttribute('rowid');*/ aa="row_"+i;} r.setAttribute('id',aa);newRow.id=aa;/*var cells=r.children ? r.children : r.childNodes;*/ var cells=r.getElementsByTagName(colName);m=cells.length;for(var j=0;j<m;j++){var c=cells[j];if(c.childNodes[0])t=c.childNodes[0].nodeValue;else t="";newRow.push(t);} this.data.push(newRow);} var e=xmlDoc.getElementsByTagName("endOfQuery");if(e && e.length>0){return 1;} else return 0;};};function dirtyNodes(menuHolder,dat,xr){var menuBar = menuHolder;var data=dat;var mUpdateDoc;var xmlRoot=xr;this.ptUpdateDocMenu = function(){var u,u2;var label="Save Changes";if(!mUpdateDoc){mUpdateDoc=f38(menuBar,label,this.updateDoc,imgFloppy);} else {mUpdateDoc.style.display = '';} };this.hideUpdateDocMenu = function(){if(mUpdateDoc)mUpdateDoc.style.display = 'none';};this.updateDoc = function(){var a,c,v,i,n,s,t,typ,z;var xmlStr=0;n=data.getSize();s="";g_requestFlag=0;while(data.getSize()){c=data.pop();a=c.val.f205;typ=eval(a.nodeType);if(a.data!=null)/* comment */ {a.data=c.val.newValue;c.val.style.cssText=styleCommentData;} else if(a.nodeType==2)/*attribute */ {if(c.val.fieldType=="nodeName"){a.nodeName=c.val.newValue;} a.nodeValue=c.val.newValue;c.val.style.cssText=styleNodeData;} else if(a.nodeType==11)/*InputHead */ {a.nodeValue=c.val.newValue;z=gParser.getInputHead();z.nodeValue=a.nodeValue;c.val.style.cssText=styleNodeData;} else {c.val.node.updateTagValue(c.val.newValue);c.val.style.cssText=styleNodeData;typ=1;} t=encodeToHex(c.val.newValue);s+=ctUpdateDbStr(a)+"~task=update"+"~typ="+typ+"~v="+t+"~end~";} if(mUpdateDoc)mUpdateDoc.style.display = 'none';z=gParser.getInputHead();xmlStr=z.nodeValue+f37(xmlRoot);makeUpdateDocRequest(s,xmlStr);return false;};};function makeUpdateDocRequest(s,xmlStr){var myObject=this;var root=this.root;var url,t;var params = new Object();var target=myObject.id;if(g_requestFlag==1)/* request sent out and waiting for respons */ return false;g_requestFlag=1;if(g_saveDocMode==1){submitToForm(g_mainScript,"saveStrToClient",xmlStr,gFn);return;} else {url=g_mainScript+"?mu=ajax&task=saveChanges&str="+s+"&l="+Math.random();params["mu"]="saveStrToClient";params["str"]=xmlStr;}  var obj=new Object();obj.target=target;ajaxInterface(url,"GET","",obj);/*new ContentLoader(url,"POST","",target,params,root);*/  };function submitToForm(url,mu,xmlStr,fn){var f=createSubmitForm("f00");var t=encodeURIComponent(xmlStr);f.baseURI=url;f201(f,"mu",mu);f201(f,"fn",fn);f201(f,"str",t);f201(f,"i","123");f.setAttribute("action",url);f.submit();};function ctUpdateDbStr(a){var p,tb,done,s,ancestors,id;p=a;if(onelevel==0)/*only oneleve mode allows to save changes to db */ return;done=0;if(a.nodeType==8)/*cmt */ {s="~tb=comment~anc="+a.parentNode.nodeName;p=a.parentNode;return;} s="";ancestors="";while(done==0){if(p && p.ptr){ancestors=p.ptr.nodeName+"/"+ancestors;tb=p.ptr.getAttribute("xo_tb");} if(tb){id=p.ptr.getAttribute("xo_id");done=1;} else if(p)p=p.parent;else done=2;} s="~tb="+tb+"~id="+id+"~anc="+ancestors;return s;};function colInfo(header,width,ci){this.header = header;this.width = width;this.ci = ci;this.contentTagId=0;this.type=1;/*1:text;5:link*/ };function loadXMLDoc(dname){var xhttp;if (window.XMLHttpRequest){xhttp=new XMLHttpRequest();} else   {xhttp=new ActiveXObject("Microsoft.XMLHTTP");} xhttp.open("GET",dname,false);xhttp.send("");return xhttp.responseXML;};function ctEditableCell(c,row,index,callbackFn){c.setAttribute("contentEditable","true");c.onmouseout=callbackFn;c.f205= new Object();c.f205.row=row;c.f205.index=index;c.editable=true;};/* zXml.js */  var nodeList=new Array();var gNumXmlObjects=0;function ctXmlDoc(str){var xmlDoc;if (window.DOMParser){var parser=new DOMParser();xmlDoc=parser.parseFromString(str,"text/xml");} else /* Internet Explorer */   {xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(str);} return xmlDoc;} function trimMe(s){var a,b;var z = new Object();var b=s.split("<");a=b[0];if(a.length>3){z.head=a;z.nodeType=11;} else {z.head="";} while(s && s.charAt(0)!='<'){a=s.substr(1,s.length);s=a;} z.body=s;return z;};/* function trimMe(s){var a,b;while(s[0] && s[0]!='<'){a=s.substr(1,s.length);s=a;} return s;};*/ function f59(){var xmlDoc;var docType;var inObject;var documentElement;this.f119 = function(t){var a,str,z;str = "<x_wrapper_>"+t+"</x_wrapper_>";inObject=trimMe(t);str=inObject.body;xmlDoc=ctXmlDoc(str);documentElement=xmlDoc.documentElement;inObject.versionStr=this.getVersionStr(str);a=documentElement;if(a.nodeName=="xsl:stylesheet"){docType="xslt";return;} if(a.nodeName=="xsl:transform"){docType="xslt";return;} if(a.nodeName=="stylesheet"){docType="xslt";return;} if(a.nodeName=="transform"){docType="xslt";return;} if(a.nodeName=="xs:schema"){inObject.prefix="xs";docType="xsd";return;} if(a.nodeName=="xsd:schema"){docType="xsd";inObject.prefix="xsd";return;} if(a.nodeName=="schema"){inObject.prefix="xs";docType="xsd";return;} docType="xml";};this.getVersionStr = function(str){var a,b,c,s;a=str.split("?>");if(a.length<2)return "";s=a[0];b=s.split("<?xml");if(b.length<2)return "";c=s+"?>";return c;};this.versionStr = function(){return inObject.versionStr;};this.getDoc=function(){return xmlDoc;};this.getPrefix = function(){return inObject.prefix;};this.getDocType=function(){return docType;};this.getInputHead = function(){var z=new Object();z.nodeValue=inObject.head;z.nodeType=inObject.nodeType;return z;};};function displayXmlString(xstr,gridid){var mynodes=f60(xstr);var xg=new f1(mynodes,gridid);xg.init();};function f60(xstr){var i,j,m;var parser = new f59();parser.f119(xstr);var xmlDoc=parser.getDoc();var docnodes = xmlDoc.childNodes;for(i=0;i<docnodes.length;i++){a=docnodes[i];if(a.nodeType==1){traverseNodeTree(a);} } return nodeList;};function traverseNodeTree(node){var a,b,c,attrs;var st = new f29();var x=new xmlNode(node);document.write("start traversal  <br>");st.push(x);st.printf29();while(!st.isEmpty()){a=st.pop();f309(a);switch(a.ptr.nodeType){case 1: b=a.ptr.childNodes;attrs=a.ptr.attributes;m=b.length;if(m==0){} else {for(j=m-1;j>=0;j--){c=b[j];x=new xmlNode(c);x.parent=a;st.push(x);} } break;} }  };function displayNodeList(nodeList){var a,b,i,j,k,n;n=nodeList.length;for(i=0;i<n;i++){a=nodeList[i];f117(a);} };function f2(a){var p=a.ptr;document.write(a.level+" "+p.nodeType+" "+p.nodeName+" "+a.tagValue+" <br>");};function f117(a){var p=a.ptr;f2(a);var attrs=a.ptr.attributes;if(attrs){for(j=0;j<attrs.length;j++){var att=attrs[j];document.write(a.level+"**"+att.nodeName+"  "+att.nodeValue+"<br>");} } var children=a.children;if(children){displayChildren(a);} };function displayChildren(a){var a,b,i,j;var children=a.children;var n=children.length;b=null;for(i=0;i<n;i++){a=children[i];if(b && a.ptr.nodeName==b.ptr.nodeName){document.write("---");} f117(a);b=a;}  };function f309_(node){var level=-2;var a=node.ptr;while(a){a=a.parentNode;level+=1;} node.level=level;switch(node.ptr.nodeType){case 1: if(node.parent)node.parent.children.push(node);else  nodeList.push(node);break;case 3: if (!isWhitespace(node.ptr.nodeValue))node.parent.tagValue=node.ptr.nodeValue;break;case 4: /* CDATASection */ if(node.parent)node.parent.children.push(node);else  nodeList.push(node);break;default: nodeList.push(node);break;} };function f309(node,parent){var a;var nt=node.nodeType;switch(node.nodeType){case 1: a=new xmlNode(node);a.parent=parent;parent.children.push(a);break;case 3: if (!isWhitespace(node.nodeValue)){parent.tagValue=node.nodeValue;if(parent.parent!=null)parent.parent.childHasTextTag++;} break;case 4: /* CDATASection */ a=new xmlNode(node);a.parent=parent;parent.children.push(a);break;case 8:/*comment*/ parent.cmts.push(node);parent.hasCmt=1;break;default: break;} };function xmlNode(p){this.ptr=p;this.parent=null;this.tagValue=null;this.attrs=new Array();this.children=new Array();this.cmts=new Array();this.htable=null;this.hrow=null;this.hcell=null;this.state=0;this.act="expand";this.f199=null;var processed=0;this.numAttrs=0;this.childHasTextTag=0;this.hasIdenticalSib=0;this.noSimplePopupMenu=0;this.hasCmt=0;this.owner=null;this.ref=null;this.deleted=0;this.group=null;this.nodeName="xmlNode";var nn=gNumXmlObjects - 0;if(this.ptr){/*this.ptr.i=nn;*/ gNumXmlObjects+=1;}  /* this.id=eval(gNumXmlObjects);gNumXmlObjects+=1;*/ /* if(p.id==null || p.id==""){this.ptr.id=eval(gNumXmlObjects);gNumXmlObjects+=1;} */ this.setProcessed = function(){processed=1;};this.getAct=function(){return this.act;};this.getChildren = function(){if(processed==1)return;var b=this.ptr.childNodes;this.attrs=this.ptr.attributes;for(var i=0;i<b.length;i++){var a=b[i];f309(a,this);} processed=1;};this.reset=function(){processed=0;this.attrs=new Array();this.children=new Array();this.cmts=new Array();};this.getChildWithTagName = function(tag){var i,n,c;this.getChildren();n=this.children.length;for(i=0;i<n;i++){c=this.children[i];if(c.ptr.nodeName==tag)return c;} };this.getChildWithTagNameJ = function(tag,j){var i,k,n,c;n=this.children.length;k=0;for(i=0;i<n;i++){c=this.children[i];if(c.ptr.nodeName==tag){if(k==j)return c;k++;} } };this.getChildWithAttribute = function(attName,attValue){var i,n,c,a;n=this.children.length;for(i=0;i<n;i++){c=this.children[i];/*a=c.ptr.attributes.getNamedItem(attName);*/ a=c.attrs.getNamedItem(attName);if(a!=null && a.nodeValue==attValue){return c;} } return null;};this.getFirstChildWithNodeType = function (nt){var i,n,c,a;n=this.children.length;for(i=0;i<n;i++){c=this.children[i];if(c.ptr.nodeType==nt)return c;} return null;};this.updateTagValue = function(newValue){var b=this.ptr;b.childNodes[0].data=newValue;this.tagValue=newValue;};this.updateAttValue = function(newValue){var b=this.ptr;alert(b);};};function isValidNodeName(a){try{var x = document.createElement(a);} catch(e){alert(e);return 0;} };function getChildrenByNodeName(a,nodeName){var i,b;var e=new Array();for(i=0;i<a.childNodes.length;i++){b=a.childNodes[i];if(b.nodeName==nodeName)e.push(b);}       return e;};function getFirstElementByAttributeName (r,nodename){var i,e;for(i=0;i<r.childNodes.length;i++){e=r.childNodes[i];if(e.attributes && e.getAttribute("name")==nodename){return e;}       } };function getFirstElementByNodeName (r,nodename,checkFlag){var i,e;for(i=0;i<r.childNodes.length;i++){e=r.childNodes[i];if(e.nodeName==nodename){if(checkFlag && e.checked)j=0;else                         return e;}       } };var gNewXmlFrm;function createNewXmlBox(){var handle,note,info;handle=document.getElementById(gridboxId);handle.innerHTML="";note="Create New XML Document";var frm=new f72(handle,note,info,0,1);frm.setFrmStyleClass("filefrm");frm.setOkText("Submit");frm.setAction(g_mainScript);frm.setDonotCloseOnSend(1);frm.init();frm.f61("Author","",40);frm.f61("Organization","",40);frm.f61("Root Element","",40,1);frm.f71(doNewXml);frm.showForm();gNewXmlFrm=frm;};function doNewXml(){var frm,a,v,s,d,i;var ename,author,org;frm=gNewXmlFrm;a=frm.getItems();author=a[0].node.value;org=a[1].node.value;ename=a[2].node.value;s="<a></a>";d=ctXmlDoc(s);e=validateNodeName(ename,d);if(!e)return;frm.close();s="<?xml version=\"1.0\" encoding=\"UTF-8\"?>";s+="<!--Document created by: "+author+","+org+" with XmlGrid Online XML Editor,http://xmlgrid.net -->\n";s+="<"+ename+"></"+ename+">\n";strToXsdGrid(s,gridboxId,0,0,0);return;};function makeExpandNodeRequest(o){var url=g_mainScript+"?mu=f155&ptb="+o.ptb+"&pid="+o.pid+"&mytb="+o.mytb+"&myid="+o.myid+"&l="+Math.random();var target=o.handle.id;var params;params="";var callBack=fnExpandNode;var root=o.root;var node=o.node;node.root=root;new ContentLoader(url,"GET",callBack,target,params,node);};function fnExpandNode(){var a=this;var node=this.obj;var t=a.xmlhttp.responseText;var h=a.resultDiv.id;fx0(t,h,1,node);};/* f130.js */ var gKeyCap;var gDisableLeftClick;function f130(){var data = new f29();var cb=this;gDisableLeftClick=0;this.isEmpty = function(){return data.isEmpty();};this.clear = function(){while(data.isEmpty()==false){var c=data.pop();cb.release(c);} };this.f202 = function(h){var f207=h.f207;var c=f207.tb.rows[f207.rowIndex+1];if(c){c.i=f207.rowIndex;c.f207.rowIndex=c.i;cb.f203(c);} };this.start = function(ev){var k;var t=this;var f207=t.f207;k=f135(ev);gCancelClick=true;if(t.f207)f63(t.f207.row);else return;if(k=="100")/*shtKey is pressed */ {cb.f131(this);} else if(k=="000"){while(data.isEmpty()==false){var c=data.pop();cb.release(c);} cb.f202(this);} else if(k="010")/*ctlKey is pressed */ {cb.f202(this);} };this.f203 = function(h){var f207=h.f207;f207.row.style.cssText="background-color:"+styleClipboardHighlightBkColor+";";data.push(h);};this.f131 = function(h){var c1=data.pop();if(c1==null){cb.f203(h);return;} var i1,i2,i,j,rows;var f2071=c1.f207;var f2072=h.f207;i1=f2071.rowIndex;i2=f2072.rowIndex;if(i1>i2){i=i2;j=i1;} else {i=i1;j=i2;} rows=f2071.tb.rows;for(i1=i;i1<=j;i1++){var c=rows[i1+1];/* 1st row in f207.td is the header */ c.i=i1;if(!cb.ifInf29(c)){cb.f203(c);data.push(c);} } var i=0;};this.release = function(me){me.f207.row.style.cssText="";};this.ifInf29 = function (c){if(data.isEmpty())return false;var i,j,n;n=data.getSize();for(i=0;i<n;i++){var a=data.getAt(i);if(a.i==c.i)return true;} return false;};this.doDelete = function(){var i,c,p,dad,ptr,tr;while(data.isEmpty()==false){c=data.pop();p=eval(c.f207.node);ptr=eval(p.ptr);if(eval(ptr.parentNode)!=null){dad=v1.deleteOneNode(p);} cb.release(c);} redrawNode(dad,p);return;dad.reset();dad.getChildren();/* if(eval(p.parentHasIdenticalChildren)==1)dad.hasIdenticalChildren=1;if(eval(dad.children.length)<1){v1.f113(dad,p.holderVbox,1);} else v1.reDrawIdenticalChildren(dad,p);*/ var v2=null;if(p.hasIdenticalSib==1){if(dad.children.length<2)v2=p.holderVbox;v1.reDrawIdenticalChildren(dad,p,v2);} else if(p.parentHasIdenticalChildren==1)v1.reDrawIdenticalChildren(dad,p);else v1.f113(dad,dad.f207,1);};this.f132 = function(){var i=0;};this.f133 = function(){var i=0;};};function f135(evt){evt = (evt)? evt : window.event; var key = gKeyCap;var ctrlPressed='0';var altPressed='0';var shiftPressed='0';if(evt.shiftKey)shiftPressed='1';if(evt.altKey)altPressed ='1';if(evt.ctrlKey)ctrlPressed = '1';var keyStatus=shiftPressed+ctrlPressed+altPressed;return keyStatus; /* Alt only              modifiers=1 (001)Ctrl only             modifiers=2 (010)Ctrl+Alt              modifiers=3 (011)Shift only            modifiers=4 (100)Shift+Alt             modifiers=5 (101)Shift+Ctrl            modifiers=6 (110)Shift+Alt+Ctrl        modifiers=7 (111)None of these keys    modifiers=0 (000)*/ };function getKey(keyStroke){var keyCode = keyStroke.which;var sKeyCode = keyStroke.keyCode;gKeyCode=sKeyCode;gKeyCap = String.fromCharCode(keyCode).toLowerCase();return gKeyCode;};function f136(ev){var cb=gCb;if(gCancelClick){gCancelClick=false;return;} if(cb.isEmpty())return;gCb.clear();var k=gKeyCode;var i=0;};function getCharCode(ev){var c=ev.charCode;return c;};function f137(ev){ev = (ev)? ev : window.event;var k=getKey(ev);var charCode = getCharCode(ev);if(gCb.isEmpty())return true;if(k==46 || k==8)/*delete or backspace key is pressed */ {if(gDisableLeftClick==1)return;gCb.doDelete();return false;} var sk=f135(ev);if(sk=='010' && charCode==99)gCb.f132();if(sk=='010' && charCode==118)gCb.f133();return;};/* draw lines between 2 divs */  var gColor="#B0ABAB";var gAdjustY=0;function setAdjustYvalue(y){gAdjustY=y;};function setColor(c){gColor=c;};function f611(box1,box2,lineStyle){var q=new f162(rootHolder,box1,box2,lineStyle);q.box1=box1;arcs.push(q);};function f162(holder,b1,b2,ls){var lineWeight=1;var lineStyle = ls ? ls : "solid";var box1,box2,h;var lineObjects=new Array();box1=b1;box2=b2;h=holder;var color=gColor;this.setColor = function (c){color=c;};this.setLineWeight = function(w){lineWeight=w;};this.setLineStyle = function(s){lineStyle=s;};this.f163 = function(mode){if(mode==2){connect2boxesMode2(lineObjects,h,box1,box2,color,lineWeight,lineStyle);} else connect2boxes(lineObjects,h,box1,box2,color,lineWeight,lineStyle);};this.f165 = function(){var i,n,a;n=lineObjects.length;for(i=0;i<n;i++){a=lineObjects[i];a.holder.removeChild(a.line);} if(this.box1)this.box1.anchor=null;lineObjects.remove(0,n);};this.ref163 = function(){this.f165();this.f163();};};function f167(x1,y1,x2,y2,color,size,style)/* horizontal/vertical line only */ {var styleLine,sty,lineStyle;sty=style? style: "solid";if (x2 < x1){var temp = x1;x1 = x2;x2 = temp;temp = y1;y1 = y2;y2 = temp;} var length = Math.sqrt((x1-x2)*(x1-x2)+ (y1-y2)*(y1-y2));var line = document.createElement("div");lineStyle=eval(line.style);if(x1==x2)/* vertical line */ {styleLine="position: absolute;border-width:0px "+size +"px 0px 0px;border-style: "+sty+";border-color: "+color+";";line.style.cssText=styleLine;lineStyle.width = size + "px";lineStyle.height = length + "px";} else /* horizontal line */ {styleLine="position: absolute;border-width:"+size +"px 0px 0px 0px;border-style: "+sty+";border-color: "+color+";";line.style.cssText=styleLine;lineStyle.width = length + "px";lineStyle.height = size + "px";} line.style.top = (y2 > y1)? y1 + "px" : y2 + "px";line.style.left = x1 + "px";return line;};/* function f167_(x1,y1,x2,y2,color,size,style){var styleLine,sty;sty=style? style: "solid";styleLine="position: absolute;height: 0px;border-width:"+size +"px 0px 0px 0px;border-style: "+sty+";border-color: "+color+";";if (x2 < x1){var temp = x1;x1 = x2;x2 = temp;temp = y1;y1 = y2;y2 = temp;} var line = document.createElement("div");line.style.cssText=styleLine;var length = Math.sqrt((x1-x2)*(x1-x2)+ (y1-y2)*(y1-y2));line.style.width = length + "px";if (IE){line.style.top = (y2 > y1)? y1 + "px" : y2 + "px";line.style.left = x1 + "px";var nCos = (x2-x1)/length;var nSin = (y2-y1)/length;line.style.filter = "progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11=" + nCos + ",M12=" + -1*nSin + ",M21=" + nSin + ",M22=" + nCos + ")";} else {var angle = Math.atan((y2-y1)/(x2-x1));line.style.top = y1 + 0.5*length*Math.sin(angle)+ "px";line.style.left = x1 - 0.5*length*(1 - Math.cos(angle))+ "px";line.style.MozTransform = line.style.WebkitTransform = line.style.OTransform= "rotate(" + angle + "rad)";} return line;};*/  function f168 (obj){var p=findPos(obj);this.width=obj.offsetWidth;this.height=obj.offsetHeight;this.xleft=p[0];this.xright=this.xleft+obj.offsetWidth;this.xmid=this.xleft+obj.offsetWidth/2;this.ytop=p[1];this.ybottom=this.ytop+obj.offsetHeight;this.ymid=this.ytop+(obj.offsetHeight/2);};function connect2boxes(lineObjcts,h,box1,box2,color,lineWeight,style){if(box1==null || box2==null)return;var p1,p2;var x1,x2,y1,y2;p1= new f168(box1);p2= new f168(box2);x1=eval(p1.xright);x2=eval(p2.xleft);y1=eval(p1.ymid);y2=eval(p2.ymid);if(x1<1 || x2<1)return;if(box1.anchor){draw2lines(lineObjcts,h,box1.anchor.x,box1.anchor.y,x2,y2,color,lineWeight,style);return;}  var anchor=connect2points(lineObjcts,h,x1,y1,x2,y2,color,lineWeight,style);box1.anchor=anchor;};function connect2boxesMode2(lineObjcts,h,box1,box2,color,lineWeight,style){if(box1==null || box2==null)return;var p1,p2,e;var x1,x2,y1,y2;p1= new f168(box1);p2= new f168(box2);x1=eval(p1.xleft)+2;x2=eval(p2.xleft);y1=eval(p1.ybottom);y2=eval(p2.ybottom);if(x1<1 || x2<1)return;e=f167(x1,y1,x1,y2,color,lineWeight,style);h.appendChild(e);a=lineObject(h,e);lineObjcts.push(a);e=f167(x1,y2,x2,y2,color,lineWeight,style);h.appendChild(e);a=lineObject(h,e);lineObjcts.push(a);};function lineObject(holder,line){var a = new Object();a.holder=holder;a.line=line;return a;};function draw2lines(lineObjcts,holder,x1,y1,x2,y2,color,lineWeight,style){e=f167(x1,y1,x1,y2,color,lineWeight,style);holder.appendChild(e);a=lineObject(holder,e);lineObjcts.push(a);e=f167(x1,y2,x2,y2,color,lineWeight,style);holder.appendChild(e);a=lineObject(holder,e);lineObjcts.push(a);}; function connect2points(lineObjcts,holder,x1,y1,x2,y2,color,lineWeight,style){var e,a;var anchor =null;if((Math.abs(y1-y2))<2){e=f167(x1,y1,x2,y2,color,lineWeight,style);holder.appendChild(e);a=lineObject(holder,e);lineObjcts.push(a);return;} var w,h,x3,y3;w=(x2-x1)/2;h=(y2-y1)/2;x3=x1+w;y3=y1+h;anchor=new Object();anchor.x=x3;anchor.y=y1;e=f167(x1,y1,x3,y1,color,lineWeight,style);holder.appendChild(e);a=lineObject(holder,e);lineObjcts.push(a); e=f167(x3,y2,x2,y2,color,lineWeight,style);holder.appendChild(e);a=lineObject(holder,e);lineObjcts.push(a);e=f167(x3,y1,x3,y2,color,lineWeight,style);holder.appendChild(e);a=lineObject(holder,e);lineObjcts.push(a); return anchor;};function findPosX(obj){var curleft = 0;if(obj.offsetParent){while(1){curleft += obj.offsetLeft;if(!obj.offsetParent)break;obj = obj.offsetParent;}   } else if(obj.x){curleft += obj.x;}    obj.style.position = "static";return curleft;};function findPosY(obj){var curtop = 0;if(obj.offsetParent){while(1){curtop += obj.offsetTop;if(!obj.offsetParent)break;obj = obj.offsetParent;}   } else if(obj.y){curtop += obj.y;}    return curtop+gAdjustY;};function findPos(obj){var left = findPosX(obj);var top = findPosY(obj);return [left ,top];};function findPosition(oElement ){if(typeof(oElement.offsetParent )!= 'undefined' ){for(var posX = 0,posY = 0;oElement;oElement = oElement.offsetParent ){posX += oElement.offsetLeft;posY += oElement.offsetTop;}     return [ posX,posY ];} else {return [ oElement.x,oElement.y ];} };/* search.js */  var gn=0;var gXPath;var gXPathNodes=new f29();function compareElem(e,t){var j,v;v=e.nodeValue;if(v){j=v.indexOf(t);if(j!=-1){return e;} } return null;};function searchAtt(e,t){var i,a,b;if(!e.attributes)return null;i=0;while(i<e.attributes.length){a=e.attributes[i];if(a){b=compareElem(a,t);if(b){gXPathNodes.push(a);return b;} } i++;} return null;};function search(e,t){var a,b,i,j,v;var done=false;i=0;gn+=1;v=e.nodeValue;b=null;b=compareElem(e,t);if(b)return b;if(searchAtt(e,t))return e;while(done==false){a=e.childNodes[i];if(!a)done=true;else {b=search(a,t);if(b){gXPath+=a.nodeName+" "+i;gXPathNodes.push(a);return b;} } i++;} };function findChildNode(a,b){var i,e;i=0;while(i<a.children.length){e=a.children[i++];if(e.ptr==b)return e } return null;};function getFirstElementByAttribute(e,akey,aval){var a,b,i,j,v;for(i=0;i<e.childNodes.length;i++){a=e.childNodes[i];if(a.nodeType==1){b=a.getAttribute(akey);if(b){if(b==aval)return a;} v=getFirstElementByAttribute(a,akey,aval);if(v!=null)return v;} } return null;};/* f171.js */ function f171(td,node,parent,noNewHolder){this.td=td;this.parent=parent;this.node=node;this.div0=null;this.div1=null;this.f179=null;this.f178=null;this.showNodeName=0;this.f206=0;this.tb=null;this.row=null;this.id=f118();if(noNewHolder!=null){} else {this.div0=f21("div");this.div1=f21("div");this.div0.appendChild(this.div1);this.td.appendChild(this.div0);}  this.init = function(parent){if(parent!=null){this.box1=parent.box1;this.box2=parent.box2;this.tb=parent.tb;this.showNodeName=parent.showNodeName;this.f206=parent.f206;this.f179=parent.f179;}   if(parent!=null){} };this.init(parent);this.childBox = function(node,div1){var c,t,p;var noNewHolder=1;p=this;t=this.td;c=new f171(t,node,p,noNewHolder);if(div1!=null)c.div1=div1;else {c.div1=p.div1;} return c;};this.f172 = function(node){var c,t,p;var noNewHolder=1;p=this;t=this.td;c=new f171(t,node,p,noNewHolder);c.iGroup=this.iGroup;var td=f25(this.row,170);var div0=f21("div");td.appendChild(div0);var div1=f21("div");div0.appendChild(div1);c.td=td;c.div0=div0;c.div1=div1;c.row=this.row;return c;};this.f173Style = function(node,sty,tdw){var v=this.f173(node,tdw);setupStyledTb(v,sty);return v;};this.f173 = function(node,tdw){var c,t,p;var noNewHolder=1;var w=tdw ? tdw : 170;p=this;t=this.div1;c=new f171(t,node,p,noNewHolder);c.iGroup=this.iGroup;c.tb=f21("table");c.tb.style.cssText=styleInerGridTable;t.appendChild(c.tb);c.row=f112(c.tb);var td=f25(c.row,w);var div0=f21("div");td.appendChild(div0);var div1=f21("div");div0.appendChild(div1);c.td=td;c.div0=div0;c.div1=div1;c.noArcs=this.noArcs;c.parent=this;return c;};this.f175 = function(node,tdw,rowHead){var c,t,p,w,div1;var noNewHolder=1;var w=tdw ? tdw : 50;p=this;t=this.div1;c=new f171(t,node,p,noNewHolder);c.iGroup=this.iGroup;c.tb=this.tb;c.row=f112(c.tb);c.row.f207=c;c.row.style.cssText="margin:0px;padding:0px;";if(rowHead==1){var th=f21("th");th.setAttribute("scope","row");div1=f21("div");c.row.appendChild(th);th.appendChild(div1);c.div0=div1;} else {var td=f25(c.row,w);var div0=f21("div");td.appendChild(div0);div1=f21("div");div0.appendChild(div1);c.td=td;c.div0=div0;} c.div1=div1;c.noArcs=this.noArcs;return c;};this.f177 = function(){var v1=this;var tb=f21("table");v1.div1.appendChild(tb);v1.row=f112(tb);v1.td=f25(v1.row,90);var c2=f21("div");v1.td.appendChild(c2);v1.div1=c2;v1.noNewTd=1;};this.rewriteDiv1=function(){var d=f21("div");this.div1.parentNode.replaceChild(d,this.div1);this.div1=d;};this.f176=function(){f27(this.div1,"&nbsp;&nbsp;");this.td.style.cssText="border-width: 0px;";var td=f25(this.row,90);this.td=td;var d=f21("span");this.td.appendChild(d);this.div1=d;this.tb=f21("table");/*this.tb.style.cssText=styleInerGridTable;*/ d.appendChild(this.tb);}; };function horizontalSpacer(h){var t=f21("div");t.style.cssText=styleSpacer;h.appendChild(t);};function setupTbHeadRow(f207){var head=f21("thead");head.setAttribute("scope","row");f207.head=head;var tr=f21("tr");var th=f21("th");f207.tb.appendChild(head);head.appendChild(tr);tr.appendChild(th);th.setAttribute("scope","col");th.setAttribute("colspan",199);f207.div2=th;};function setupStyledTb(f207,sty){var z=f207.parent.div1;var z1=f21(sty);z.appendChild(z1);f207.tb=f21("table");z1.appendChild(f207.tb);var r=f112(f207.tb);f207.row.parentNode.removeChild(f207.row);f207.tb.appendChild(r);f207.row=r;f207.td=f25(f207.row);f207.div0=f21("div");f207.div1=f21("div");f207.div0.appendChild(f207.div1);f207.td.appendChild(f207.div0);};/* f1.js */  var ascPointer = "&#8593;";var descPointer ="&#8595";var onelevel=0;var gFrm;var dirtyList;var gWorkElemList;var rootHolder;var dn;var menuBar;var gMu=0;var gFn;var gSaveFileMu=0;var gSaveFileFlag=0;var v1;var gCb;var gKeyCode;var gCancelClick;var gRoot;var arcs;var gSelectedNode;function setInputFileName(fn){gFn=fn;};function loadXmlFromXmpTag(dataId,gridId,onelevel,parentNode,muBarId,fn){var c=document.getElementById(dataId);var t=getNodeValue(c);gFn=fn;/*t=t.replace(/>/gi,">\n");*/ strToXsdGrid(t,gridId,onelevel,parentNode,muBarId);};function fx0(xstr,gridid,onelevel,parentNode,muBarId,debugFlag){var parser = new f59();parser.f119(xstr);var xmlDoc=parser.getDoc();var xg=new f1(xmlDoc,gridid);if(onelevel==1)xg.setOneLevel(1);if(parentNode)xg.setParentNode(parentNode);if(muBarId)xg.setMuBarId(muBarId);if(debugFlag)xg.setDebugFlag();if(gFn==null)gFn="default.xml";setColor("green");/*link line color */ documentChanged();xg.init();};function f1(rt,gridid){var root=rt;var xTree;var mubarId;var menuBar;var inputHeadBox;var searchBox;var searchInput;var holderId=gridid;var tmpNameId,tmpValId;var parentNode;var serverRequestFlag;var debugFlag=0;this.dataTable = f21("table");v1=this;var lineMode=2;var lineStyle="dotted";this.mode=0;/* default 0: edit mode,2: viewer mode;6: xmlToText*/ var rootVbox;var docType;var xo_flag=0;/* default 0: ignore xo_ attribute prefix;1: do not print attribute with xo_ prefix */ var versionStr;var gridView;var textView;var textViewCreated=0;gCb = new f130();var a,b,i,j,k,n;this.setMode = function(m){if(m)this.mode=m;else this.mode=0;};this.setVersionStr = function (v){versionStr=v;};this.setDebugFlag = function(){debugFlag=1;};this.setMuBarId = function (id){mubarId=id;};this.setHolderId =function(id){holderId = id;};this.setRoot =function(rt){root= rt;};this.getRoot =function(){return root;};this.setParentNode = function(p){parentNode=p;};this.setOneLevel = function(){onelevel=1;};this.getXTree = function(){return xTree;};this.getFirstElement = function(){var i,a;for(i=0;i<root.childNodes.length;i++){a=root.childNodes[i];if(a.nodeType==1)return a;} return null;};this.init = function(){var a,i,b,c;var f207;xTree=new xmlNode(0);var docnodes = root.childNodes;gRoot=root;var d=document.getElementById(holderId);rootHolder=d;a=docnodes[0];b=a.nodeName;if(b=="parsererror"){d.textContent=a.textContent;return;} arcs=new Array();this.dataTable.style.cssText=styleGridTable;var r=f112(this.dataTable);var td=f25(r,90);f207=new f171(td,a);f207.f206=1;f207.tb=this.dataTable;d.oncontextmenu = this.disableEvent;d.onclick = f136;/*document.onkeypress = getKey;*/  document.onkeydown=f137;menuBar=f21("div");inputHeadBox=f21("div");gMu=new Object();dirtyList=new f30();gWorkElemList=new f30();dn = new dirtyNodes(menuBar,dirtyList,root);f27(menuBar,"");d.appendChild(menuBar);d.appendChild(inputHeadBox);{gridView=f21("div");textView=f21("div");d.appendChild(textView);d.appendChild(gridView);gridView.appendChild(this.dataTable);}  if(this.mode!=6){var rh=ctCmdIcon(this.reloadSource,imgReload,"Rebuild node tree from the casched XML source.");menuBar.appendChild(rh);var fh=ctCmdIcon(this.showSearchBox,imgFind,"Find in document.");menuBar.appendChild(fh);this.ctFindFrm();var vh=ctInputButton(this.f315View,"TextView","change display view");menuBar.appendChild(vh);vh.img0="GridView";vh.i=0;vh.gridView=gridView;vh.textView=textView;vh.textViewCreated=0;vh.lineMode=2;} this.ptInputHead(f207);this.ptDoc(f207,docnodes);rootVbox=f207;return;};this.f315View = function(){var a=this;var t=a.defaultValue;a.defaultValue=a.img0;/* if(IE)a.value=t;else a.img0=t;*/ a.img0=t;var v=a.gridView;if(a.i==0){v.style.cssText="display:none;";a.i=1;v1.drawArcs(arcs,lineMode);v1.textViewOn(a);} else {a.textView.style.cssText="display:none;";v.style.cssText="display:";a.i=0;v1.drawArcs(arcs,a.lineMode);} };this.textViewOn = function(a){a.textView.style.cssText="display:;";if(a.textViewCreated==0 || gSaveFileFlag==1){document.body.style.cursor = 'wait';f301.init(a.textView,gRoot,versionStr);a.textViewCreated=1;document.body.style.cursor = 'default';} };this.ptDoc = function(f207,docnodes){var a,i;xTree=new xmlNode(0);for(i=0;i<docnodes.length;i++){a=docnodes[i];{x=new xmlNode(a);xTree.children.push(x);} } for(i=0;i<xTree.children.length;i++){a=xTree.children[i];if(onelevel==1){if(parentNode)/*parentNode.ptr.appendChild(a.ptr);*/ parentNode.ptr.parentNode.replaceChild(a.ptr,parentNode.ptr);serverRequestFlag=0;this.f12(a,d);} else {f207.node=a;var v=f207.f173Style(a,"style0",15);if(a.ptr && a.ptr.nodeType==1)this.f12(v);else this.f2(v);} } };this.ptInputHead = function(f207){var z=gParser.getInputHead();if(z.nodeValue.length>3){var pre=f21("pre");pre.style.cssText=styleNodeData;inputHeadBox.appendChild(pre);pre.innerHTML=z.nodeValue;pre.ondblclick=this.f77;pre.onmouseover=f73;pre.onmouseout=unHighlightField;pre.f205=z;} };this.reloadSource = function(){var p=gParm;strToXsdGrid(p.xstr,p.gridid);};this.createNewElement = function (name){var a=root.createElement(name);return a;};this.disableEvent = function(){return false;};this.f12 = function(f207,expandFlag){var e,h,f;e=f207.node;h=f207.div1;var ii=eval(f207.expandSiblings);if(!eval(e.ptr)){a=e.node;f=1;} else {a=e;f=0;} f207.f206=0;if(f207.f178!=null && !expandFlag){f207.div1.parentNode.replaceChild(f207.f178,f207.div1);f207.div1=f207.f178;var nodeNameH=f207.nodeNameHandle;var h9 = f21("span");h9.root=this;var m2=this.f106(a,h9,1);if(nodeNameH!=null){nodeNameH.appendChild(h9);nodeNameH.oncontextmenu=m2.showMenu;}  f207.f178=null;} else {var p=a.ptr;var a1=p.getAttribute("xo_expand");if(a1=='1' && serverRequestFlag==1){var o=new Object();o.ptb=p.getAttribute("xo_ptb");o.pid=p.getAttribute("xo_pid");o.mytb=p.getAttribute("xo_tb");o.myid=p.getAttribute("xo_id");o.handle=h;o.root=this;o.node=a;makeExpandNodeRequest(o);return;} f207.rewriteDiv1();if(f207.hasIdenticalChildren==1){this.f121(f207);f611(f207.parent.box1,f207.box2,lineStyle);f207.box2NodeName=f207.box2.node.ptr.nodeName;f207.box1NodeName=f207.box1.node.ptr.nodeName;} else if (ii==1){this.expandSiblings(f207);} else  {a.reset();a.getChildren();this.f2(f207,0,1);f611(f207.box1,f207.box2,lineStyle);f207.box2NodeName=f207.box2.node.ptr.nodeName;if(f207.box1)f207.box1NodeName=f207.box1.node.ptr.nodeName;else f207.box1NodeName="";} /* if(a.hasIdenticalSib==0 && a.parent && (a.parent.numAttrs>0 || a.parent.childHasTextTag>0))holder.colSpan=2;a.expandedHolder=holder;holder.setAttribute("cellType","head");if(f==1)f20(tb.dataTable,0);*/ } if(f207.noArcs!=1)this.reviseArcs(f207);this.drawArcs(arcs,lineMode);};this.reviseArcs = function(f207){var p,me,p0,p1,p2;var done=0;p0=p1=f207;p=eval(f207.parent);while(p && done==0){if(p.box1NodeName){if(p0.box1NodeName==p.box2NodeName)f611(p.box1,f207.box2,lineStyle);else  done=1;p0=p;} p=p.parent;} };this.f13=function(f207){var a,r,div0,div1;div1 = f21("div");f207.f178=f207.div1;f207.div1.parentNode.replaceChild(div1,f207.div1);f207.div1=div1;f207.f206=1;f207.node.ptSibling=0;this.f2(f207,0,0);this.reviseArcs(f207);this.drawArcs(arcs,lineMode);};this.f2=function(f207,cellOffset,lastRow){var a,co,i,j,n;a=f207.node;var p=a.ptr;if(cellOffset==null)co=a.level;else co=cellOffset;this.f7(f207,co,0,lastRow);if(f207.f206==1){return;} if(a.tagValue==null && a.attrs.length==0 && a.children.length==0)return;var v2=f207.f173Style(a,"style0",20);v2.f176();v2.f206=1;switch(p.nodeType){case 1: if(a.tagValue && a.tagValue!="\n"){var v3=v2.f175(a);this.f9(v3,2,0,1);} a.numAttrs=this.f3(v2);a.getChildren();n=a.children.length;if(n==1){if(a.numAttrs>0)v2=v2.f173Style(a.children[0],"style1");v2.node=a.children[0];this.f2(v2,1,1);} else if(n>1){this.f5(v2);}  f207.box2=v2.box2;break;} };this.ptOneAttribute = function(a,f207,att,lastRow){var i,c,c0,c1,c2,e;var t=att.nodeName.substr(0,3);if(t=="xo_" && debugFlag==0 && xo_flag ==1)return;var r=f207.row;f207.td.parentNode.removeChild(f207.td);var v2=f207.f172(att);r.onmouseover=f62;r.onmouseout=f63;c0=v2.td;c0.style.cssText=f78(1,0,lastRow,1);/* (top,right,bottom,left)*/  var ca=f21("span");c1=f21("span");c3=f21("span");ca.innerHTML="@";c1.style.cssText=styleAttributeHeader;f18(c1,att.nodeName);c1.node=a;c1.root=this;c1.f205=att;c1.changedName=att.nodeName;c1.ondblclick=this.f77;c1.workElemType="attName";c0.appendChild(c3);c3.appendChild(ca);c3.appendChild(c1);var mu=new f39(c3);mu.init();var p=new Object();p.owner=a;p.data=att;p.root=this;e=mu.f70("Show XPath",this.showPath,p.data);e.node2=a;if(this.mode==0)mu.f70("Delete Attribute",this.f68,p);c1.oncontextmenu=mu.showMenu;var v3=f207.f172(att);c=v3.td;c.style.cssText=styleNodeData+f78(1,1,lastRow,1);/* (top,right,bottom,left)*/ c2=f21("span");c.appendChild(c2);c2.style.cssText=styleNormalText;f27(c2,att.nodeValue);c2.node=a;c2.root=this;c2.f205=att;/*c2.ondblclick=this.f77;*/ c2.onblur=v1.onChange;c2.setAttribute("contentEditable","true");if(att.name=="src" && a.ptr.nodeName=="img"){displayImgThumb(c,att.nodeValue);}   };this.f3= function(f207){var a,i,n,att,lastRow;a=f207.node;var atts=a.ptr.attributes;n=eval(atts.length);if(n==0)return;lastRow=0;var v2=f207.f173Style(a,"style1");v2.row.parentNode.removeChild(v2.row);for(i=0;i<n;i++){if(i==n-1)lastRow=1;att=atts[i];var v=v2.f175(a,50);this.ptOneAttribute(a,v,att,lastRow);} return n;};this.doCancel = function(){return false;};this.f6 = function(f207,lastRow){var e,a,b;e=f207.node;a=e.node;f207.hasIdenticalChildren=1;f207.nodeName=a.ptr.nodeName;f207.node.nodeType=9;this.f10(f207);return f207.div1;};this.setSelectedNode = function(){var p,i;gSelectedNode=this.node;i=gSelectedNode.nodeName;};this.f10 = function(f207,nname,k){var a,c,holder,u,t,p;var myName;var txt,t6;a=f207.node;a.f207=f207;if(a.group)a.group.f207=f207;if(f207.nodeName)myName=f207.nodeName;else if(nname)myName=nname;else {if(!eval(a.ptr)){p=a.node.ptr;} else {p=a.ptr;} myName=p.nodeName;}  t6=ctRadioButton(this.setSelectedNode);t6.node.node=a;t6.f207=f207;f207.td.colSpan=f207.tdColSpan ? f207.tdColSpan : 2;f207.row.style.cssText="margin: 8px;height:20px;";/* f207.div3=f21("span");f207.div1.appendChild(f207.div3);f207.div3.style.cssText="text-align:left;padding: 1px 2px 1px 2px;";*/ f207.div2=f21("span");f207.div1.appendChild(f207.div2);c=f207.div2;c.style.cssText="text-align:left;padding: 1px 2px 1px 2px;";holder = f21("span");holder.setAttribute("class","button1");holder.root=this;c.appendChild(holder);if(!a.notExpand){if(f207.f206==1){t=ctCmdIcon(this.f15,imgArrowRight,"expand this node",a);} else {t=ctCmdIcon(this.f15,imgArrowDownRight,"collapse this node",a);}  t.handle=c;t.root=this;t.f207=f207;f207.box1=t;a.actHandle=t;} else {t=f21("span");}  holder.appendChild(t);t = f21("span");if(this.mode==6)holder.appendChild(t6);holder.appendChild(t);if(k && k>1)txt=" "+myName+"("+k+")";else if(a.n>1){txt=" "+myName+"("+a.n+")";} else txt=" "+myName;f27(t,txt);if(a.ptr!=null && a.noSimplePopupMenu==0){if(a.f199!=null){var mu=a.mu;var h1=mu.getHolder();holder.appendChild(h1);holder.oncontextmenu=mu.showMenu;} else {this.f106(a,holder,1);a.nodeNameHandle=t;} } if(a.hasIdenticalSib!=1)c.colSpan=4;};this.f7 = function(f207,cellOffset,skipTagName,lastRow,lastCol){var c,a,k,nAttrs,tagV,myName;a=f207.node;var tb=f207.tb;var p=eval(a.ptr);if(p)myName=p.nodeName;else {myName=f207.nodeName;p=a;} tagV=a.tagValue;if(cellOffset==null)co=a.level;else co=cellOffset;var cmtH;var hh=0;switch(p.nodeType){case 1: k=0;a.getChildren();n=a.children.length;if(n==0){/*k=this.groupIdenticalSiblings(a);*/ if(a.group)k=a.group.n;else k=0;nAttrs=a.attrs.length;} if((tagV && f207.f206==0 && nAttrs<1)|| (a.parent!=null && n==0 && k<2 && nAttrs<1)|| (n==0 && a.ptSibling==1)|| f207.ptTagVal==3){if(f207.ptTagVal>0){this.procTagValue(f207,skipTagName,lastRow,lastCol);}                    else if(n==0){f207.node.notExpand=1;this.procHeader(f207);skipTagName=1;this.procTagValue(f207,skipTagName,lastRow,lastCol);} else {c=this.procTagValue(f207,skipTagName,lastRow,lastCol);} cmtH=this.f8(a,f207,f207.div1);} else  {this.f10(f207,myName,k);a.hcell=c;cmtH=this.f8(a,f207,f207.div1);if(cmtH!=null)f207.box2=cmtH;else f207.box2=f207.box1;} break;case 4:/* CData */ this.ptCData(f207,p);break;case 8: var v=f207.f175(a);v.td.colSpan=2;this.doOneCmt(a,a.ptr,v);break;case 9:/* */ this.f10(f207,myName);break;} return f207.box2;};this.ptCData = function(f207,p){var c,s;c=f21("div");c.style.cssText="border:1px solid gray;font-style:italic;font-size: 11px;";f207.td.appendChild(c);c.innerHTML=p.nodeName;s=getNodeValue(p);c=f21("textarea");c.setAttribute("rows","5");c.setAttribute("cols","30");f207.td.appendChild(c);c.innerHTML=s;c.contentEditable=true;c.onmouseout=this.onChange;c.f205=p;};/* this.cdataChanged = function(){var newValue,oldValue;var c=this;newValue=c.value;oldValue=c.defaultValue;c.f205.nodeValue=newValue; var i=0;};*/ this.procTagValue = function(f207,skipTagName,lastRow,lastCol){var c;c=this.f9(f207,skipTagName,lastRow,lastCol);f207.row.onmouseover=f62;f207.row.onmouseout=f63;f207.box2=f207.td;f207.box2.node=f207.node;return c;};this.procHeader = function(f207,myName,k){this.f10(f207,myName,k);/*   a.hcell=c;cmtH=this.f8(a,f207,f207.div1);if(cmtH!=null)f207.box2=cmtH;else */        f207.box2=f207.box1;};this.displayCmt = function (t,d){eval(d.childNodes)[0].data=t;/* */ };this.ctCmtMenu = function(a,b,f207,d){var mu=new f39(d);mu.f70("Show XML Source",this.showXmlSrc,b);var p =new Object();p.owner=a;p.data=b;p.root=this;p.displayHandle=d;mu.f70("Delete Comment",this.f66,p);mu.init();return mu;};this.doOneCmt=function(a,b,f207){var d0=f21("div");var d=f21("div");f207.div1.appendChild(d0);d0.appendChild(d);d.node=a;d.root=this;d.f207=f207;d.f205=b;d.onmouseover=f73;d.onmouseout=unHighlightField;var mu=this.ctCmtMenu(a,b,f207,d);d.mu=mu;d.oncontextmenu=mu.showMenu;var v=f21("div");d.appendChild(v);f27(v,b.data);v.onblur=v1.onChange;v.setAttribute("contentEditable","true");v.style.cssText=styleCommentData;v.node=a;v.root=this;v.f207=f207;v.f205=b;return d;};this.f8=function(a,f207,holder){var i,n,b,c;if(f207.cmtPrinted)return;n=a.cmts.length;if(n<1)return;for(i=0;i<n;i++){b=a.cmts[i];c=this.doOneCmt(a,b,f207);} return c;};this.f9 = function(f207,skipTagName,lastRow,lastCol)/*node name and value*/ {var a,c,cc,p,r,tb,sty,row,holder;a=f207.node;p=a.ptr;row=f207.row;if(skipTagName==1){r=row;} else if(skipTagName==2)/* node has nodeValue and child nodes */ {f207.td.parentNode.removeChild(f207.td);c=f25(row,60);sty=styleItalicText+f78(1,0,lastRow,1);c.style.cssText=sty;f27(c,"tagValue");} else {c=f207.td;sty=styleNodeHeader+f78(1,0,lastRow,1);c.style.cssText=styleNodeHeader;f27(c,p.nodeName);var b=new Object();b.node=a;b.root=this;c.root=this;this.f106(a,c,1);} if(skipTagName==1)holder=f207.div1;else {var v=f207.f172(a);holder=v.td;}  if(a.tagValue==null){/*sty=styleNullTagCell+f78(1,lastCol,lastRow,1);*/ sty=styleNullTagCell;} else {/*sty=styleNodeData+f78(1,lastCol,lastRow,1);*/ sty=styleNodeData;}  c=f21("span");holder.appendChild(c);c.style.cssText=sty;c.node=a;c.root=this;a.hcell=c;this.f106(a,c,0);var c2=f21("span");c.appendChild(c2);c2.node=a;c2.root=this;c2.style.cssText=sty;c2.onblur=v1.onChange;c2.setAttribute("contentEditable","true");c2.f205=a;f27(c2,a.tagValue);return c;};this.f68 = function(){var a,p,q,t;a=this.node;t=a.data.nodeName;p=a.owner;p.ptr.removeAttribute(t);p.reset();p.getChildren();p.node=p;a.root.f113(p,p.f207,1);return;};this.deleteOneNode = function (me){var dad;me.deleted=1;dad=eval(me.parent);dad.ptr.removeChild(me.ptr);dad.node=dad;return dad;};this.f67 = function(){var me,dad,v2;me=this.node;var holderVbox=me.holderVbox;dad=v1.deleteOneNode(me);dad.holderVbox=holderVbox;redrawNode(dad,me);};this.reDrawDoc = function(){var i,a;documentChanged();t = f21("table");this.dataTable.parentNode.replaceChild(t,this.dataTable);this.dataTable=t;t.style.cssText=styleGridTable;var docnodes = root.childNodes;var r=f112(this.dataTable);var td=f25(r,90);a=docnodes[0];var f207=new f171(td,a);f207.f206=1;this.ptDoc(f207,docnodes);};this.f66 = function(ev){var a,b,p,t;a=this.node;var f207=a.displayHandle.f207;p=a.owner;f207.node=p;b=eval(a.data);t=b.parentNode.nodeType;b.parentNode.removeChild(b);if(t==9)/* document type */ {v1.reDrawDoc();return;}  p.reset();p.getChildren();a.node=p;a.root.f113(a,f207,1);return;};this.f77=function(){var i,t;var a=this.node;var c=this;/* c.styleRes=c.style.cssText;var sty0="position:absolute;z-index:100;background-color: white;border-style: solid;border-color: #7A5D48;border-width: 1px 1px 1px 1px;font-family: Verdana,Arial;font-size:12px;color:#82878C;padding:0px 2px 0px 2px;";c.style.cssText=sty0;*/ c.setAttribute("contentEditable","true");gDisableLeftClick=1;c.onblur=v1.onChange;};this.onChange = function(){var c=this;if(c.styleRes)c.style.cssText=c.styleRes;var newV=getNodeValue(c);v1.doChange(c,newV);gDisableLeftClick=0;/*set to 1 in f1.js f77 */ documentChanged();};this.doChange = function(c,newVal){var e,b0,i,t,t0,b;var normalStyle;var a=c.node;if(newVal)t=newVal;else t=c.textContent || c.innerText;b=c.f205;e=gWorkElemList.get(c.id);normalStyle=c.style.cssText;if(e!=null){t0=e.val.val;normalStyle=e.val.sty;} else {if(b.nodeType==null && a.tagValue!=null)/* tag value */ {t0=a.tagValue;normalStyle=styleNodeData;} else if(b.nodeType==null)/* tag value */ {t0=a.tagValue;normalStyle=styleNodeData;} else if(b.nodeType==1)/* annotation */ {t0=b.nodeValue;normalStyle=styleNodeData;} else if(b.nodeType==2)/* attribute */ {/*if(c.workElemType=="attName"){t0=b.nodeName;} else t0=b.nodeValue;*/ c.node.ptr.setAttribute(b.nodeName,newVal);} else if(b.nodeType==4)/* cdata */ {t0=b.data;t=c.value;normalStyle=styleNodeData;} else if(b.nodeType==8)/* comment */ {t0=b.data;normalStyle=styleCommentData;} else if(b.nodeType==11)/* InputHead */ {t0=b.nodeValue;normalStyle=styleNodeData;} else return false;var v=new Object();v.val=t0;v.sty=c.style.cssText;gWorkElemList.add(c.id,v);}  if(t==t0){c.style.cssText=normalStyle;if(c.dirty){dirtyList.remove(c.id);c.dirty=false;} else return false;} else {c.style.cssText+=styleChangedData;if(t.length<1)c.style["backgroundColor"]="#90BAE8";else {var bcc=c.style["backgroundColor"];if(bcc.length>3)c.style["backgroundColor"]="white";} c.dirty=true;c.newValue=t;dirtyList.update(c.id,c);}  switch(b.nodeType){case 2: if(c.workElemType=="attName"){if(validateStr("Attribute Name",t)==true && t!=b.changedName){a.ptr.setAttribute(t,b.nodeValue);a.ptr.removeAttribute(b.changedName);b.changedName=t;} } /* else a.ptr.setAttribute(b.changedName,t);*/ break;case 8: /* cmt */ b.data=t;break;default: c.f205.updateTagValue(t);break;} if(b.nodeType!=8)/* comment */ f27(c,t);i=dirtyList.getSize();if(i>0 && v1.mode!=6){dn.ptUpdateDocMenu();} else {dn.hideUpdateDocMenu();} };this.f106 = function(a,holder,flag,node2){var h2,e;var p=a.ptr;if(!p)p=a;var mu=new f39(holder,0,h2);/*a.mu=mu;*/ mu.f70("Show XML Source Code",this.showXmlSrc,p);e=mu.f70("Show XPath",this.showPath,p);if(node2)e.node2=node2;if(this.mode==0 && flag==1){if(a.hasIdenticalSib!=1)mu.f70("Delete Node",this.f67,a);mu.f70("Insert",0,a,this.ctInsertSubMenu);} mu.init();holder.oncontextmenu=mu.showMenu;return mu;};this.ctInsertSubMenu = function(c){var p=new Object();p.node=c.node;p.root=c.root;var holder = f21("span");var mu=new f39(holder,100);mu.f70("Comment",c.root.insertCmt,p);mu.f70("Attribute",c.root.insertAttribute,p);p.insertChild=0;if(c.node.tagValue==null)mu.f70("Node Value",c.root.f65Value,p);if(c.node.parent!=null)mu.f70("Sibling Node",c.root.f65,p);p=new Object();p.node=c.node;p.root=c.root;p.insertChild=1;mu.f70("Child Node",c.root.f65,p);mu.init();holder.oncontextmenu=mu.showMenu;c.appendChild(holder);c.subMenu=mu;};this.f65Value = function(){var c=this;var p=this.node;var a=p.node; var f207=eval(a.f207);var h=f207.div2;var hb=f207.hBox;var f=a.form;if(f==null || hb==null){var t="Node: "+a.ptr.nodeName;a.getChildren();f=new f72(h,"Add Node Value",t,p);f.f71(p.root.f71Value);tmpValId=f.f61("Node Value","",40);f.init();a.form=f;} else {f.showForm();} };this.f71Value = function(fm,frmItems,node){var a,b,name,val;p=node;a=p.node;b=document.getElementById(tmpValId);val=b.value;var t = root.createTextNode(val);a.ptr.appendChild(t);a.reset();a.getChildren();p.root.f113(p,a.f207,1); };this.f65 = function(){var h,t,info;var c=this;var p=this.node;var a=p.node;var f207=eval(a.f207);h=f207.div2;var hb=f207.hBox;if(h.offsetWidth<2)h=f207.div0;var f=a.form;if(eval(p.insertChild)==1){t="Insert Child Node";info="Parent Node: "+a.ptr.nodeName;} else {t="Insert New Node";info="As a Sibling Before Node: "+a.ptr.nodeName;} if(f==null || hb==null){a.getChildren();f=new f72(h,t,info,p);f.f71(p.root.f71);tmpNameId=f.f61("New Node Name","",30,1,v1.validateNodeName);tmpValId=f.f61("New Node Value","",30);f.init();a.form=f;} else {f.showForm();} };this.f71 = function(fm,frmItems,node){var a,b,name,val,p;p=node;a=eval(p.node);b=document.getElementById(tmpNameId);name=b.value;b=document.getElementById(tmpValId);var newNode = root.createElement(name);if(eval(p.insertChild)==1){a.ptr.appendChild(newNode);p=a;} else {var q = a.ptr.parentNode;var s= a.ptr;q.insertBefore(newNode,s);p=a.parent;a=p;} val=b.value;var t = root.createTextNode(val);newNode.appendChild(t);p.reset();p.getChildren();p.node=p;node.root.f113(p,a.f207,1);};this.insertAttribute = function(){var c=this;var p=this.node;var a=p.node;var f207=eval(a.f207);var h=f207.div2;if(h.offsetWidth<2)h=f207.div0;var hb=f207.hBox;var f=a.form;if(f==null || hb==null){var t="Node: "+a.ptr.nodeName;a.getChildren();f=new f72(h,"Add New Attribute",t,p);f.setHeight(170);f.f71(p.root.f69);tmpNameId=f.f61("Attribute Name","",30,1,v1.validateAttrName);tmpValId=f.f61("Attribute Value","",30);f.init();a.form=f;} else {f.showForm();} };this.validateNodeName = function(){var v=this.value;var i=validateStr("Node Name",v,root);};this.validateAttrName = function(){var v=this.value;var i=validateStr("Attribute Name",v);};this.f69 = function(fm,frmItems,node){var a,b,name,val;p=node;a=p.node;name=document.getElementById(tmpNameId);val=document.getElementById(tmpValId);a.ptr.setAttribute(name.value,val.value);a.reset();a.getChildren();p.root.f113(p,a.f207,1);};this.insertCmt = function(){var c=this;var p=this.node;var a=p.node;var f207=a.f207;var h=f207.div2;if(h.offsetWidth<2)h=f207.div0;var hb=f207.hBox;var f=a.form;if(f==null || hb==null){var t="Node: "+a.ptr.nodeName;a.getChildren();f=new f72(h,"Add New Comment",t,p);f.setWidth(460);f.setHeight(150);f.f71(p.root.f115);tmpValId=f.f61("Comment","",60);f.init();a.form=f;} else {f.showForm();} };this.f115 = function(fm,frmItems,node){var p,a,b,name,val;p=node;a=p.node;b=document.getElementById(tmpValId);val=b.value;b=root.createComment(val);a.ptr.appendChild(b);a.reset();a.getChildren();a.f207.node=a;p.root.f113(p,a.f207,1);};this.f113 = function(p,f207,expandFlag){var a=p.node;documentChanged();if(a.f199!=null){a.f199=null;this.f12(a,h);return;}  var h0=a.expandedHolder;if(h0!=null){a.state-=1;this.f12(a,h0);return;}   if(expandFlag){this.f12(f207,expandFlag);return;}  f207.td.style.cssText=styleInerGridTable;var div1=f21("div");f207.div1.parentNode.replaceChild(div1,f207.div1);f207.div1=div1;p.root.f7(f207);if(a.hasIdenticalSib==0 && a.parent && (a.parent.numAttrs>0 || a.parent.childHasTextTag>0))f207.td.colSpan=2;};this.showPath = function(ev){var a,b,d,e,s,t;a=this.node;t=this;b=getPath(a,this.node2);s="<textarea rows='5' cols='30'>"+b+"</textarea>";var c=f21("span");this.menuHandle.parentNode.appendChild(c);d=f21("div");d.innerHTML=s;popupBoxG(c,d);/*popupBox(ev,c,s,1);*/  };this.viewXmlSrc = function(){var url,title,options;title="XML Source";options="status = 1,height = 350,width = 400,resizable = 0";url="xmlSrc.xml";popupWindow(url,title,options);};this.showXmlSrc = function(ev){var a,b,t;a=this.node;b=f37(a);var c=f21("span");this.menuHandle.parentNode.appendChild(c);popupBox(ev,c,b);return;/* console.log(b);*/ };/* this.f120 = function(e,b,f207,htable){var a,c,p,q,i,j,k,n,r,t,txt,b2;var nodeName;var alist=new f30();var nlist=new f30();this.f10(f207);var v2=f207.f173Style(b,"style1");v2.nodeName=f207.nodeName;v2.node.nodeType=f207.node.nodeType;v2.td.colSpan=3;var b=e.node.parent.children;this.ctCompleteNodelist(e,b,alist,nlist);this.f16(v2,0,alist,nlist);this.f158(v2,b,v2.tb,alist,nlist,0);};*/ this.ctCompleteNodelist = function(e,b,alist,nlist){var c,p,q,i,j,n,r,t,att;var start,end;if(e){start=e.start;end=e.end;} else {start=0;end=b.length-1;}  for(i=start;i<=end;i++){if(i==e.end)lastRow=1;lastCol=0;p=b[i];var atts=p.ptr.attributes;n=atts.length;for(j=0;j<n;j++){att=atts[j];t=att.nodeName;c=alist.get(t);if(c==null)alist.add(t,"1");}  n=p.children.length;for(j=0;j<n;j++){q=eval(p.children[j]);t=q.ptr.nodeName;c=nlist.get(t);if(j>0){var w=eval(p.children[j-1]).ptr.nodeName;nlist.aggregate(t,1,w);} else nlist.aggregate(t,1);} } };this.f106ForSibling = function(a,holder){var p=a.ptr;var mu=new f39(holder);mu.init();mu.f70("Delete Row",this.f67,a);mu.f70("Duplicate Row",this.duplicateNode,a);holder.oncontextmenu=mu.showMenu;};this.reDrawIdenticalChildren = function(dad,me,mf207){var e,p,f207;var dadVboxSave;dad.hasIdenticalChildren=1;dad.f207.hasIdenticalChildren=1;var g=f19(dad);e=me.iGroupMember;p=findIdenticalNodeGroupMember(g,me.iGroupMember);if(mf207)f207=mf207;else if(dad.holderVbox){dad.f207=me.f207.parent;dad.f207=dad.holderVbox;dad.hasIdenticalSib=1;dad.f207.hasIdenticalSib=1;f207=dad.f207;} else if(p && eval(p.n)>0){dadVboxSave=dad.f207;dad.f207=me.f207.parent.parent;dad.f207.node=p;dad.f207.iGroup=g;f207=dad.f207;} else {dad.hasIdenticalChildren=0;dad.f207.hasIdenticalChildren=0;f207=dad.f207;} if(p){f207.node.start=p.start;f207.node.end=p.end;f207.node.n=p.n;}  f207.hasIdenticalChildren=1;v1.f113(dad,f207,1);if(dadVboxSave){dad.f207=dadVboxSave;f207=dad.f207;f207.hasIdenticalChildren=0;dad.f207.node.hasIdenticalChildren=0;} };this.duplicateNode = function(){var me,dad,p,q;me=this.node;dad=eval(me.parent);p=me.ptr;q=p.cloneNode(true);dad.ptr.insertBefore(q,p);dad.reset();dad.getChildren();dad.node=dad;v1.reDrawIdenticalChildren (dad,me);};this.f158 = function(f207,b,tb,alist,nlist,hasCmt){var e,i,j,k,kk,n,p,q,r,c,c1,t;var att,lastRow,lastCol;var start,end;var b2,tagVal;e=f207.node;tb=f207.tb;if(e && e.n){start=e.start;end=e.end;} else {start=0;end=b.length-1;} lastRow=0;kk=0;for(i=start;i<=end;i++){kk+=1;if(i==end)lastRow=1;lastCol=0;p=eval(b[i]);if(f207.node.ptSibling)p.ptSibling=f207.node.ptSibling;p.iGroupMember=e;tagVal=p.tagValue;var rowHeadFlag=1;var v=f207.f175(p,50,rowHeadFlag);p.f207=v;c=v.div1;f27(c,kk);b2=c;var w=new Object();w.i=i;w.rows=b;c.obj=w;c.node=p;p.parentHasIdenticalChildren=1;this.f106ForSibling(p,c);c.f207=v;v.rowIndex=i;c.onclick=gCb.start;n=p.cmts.length;if(hasCmt==1){var v2=v.f172(ta);/*v2.div1.style.cssText=styleCommentData2+f78(1,lastCol,lastRow,1);*/ v2.div1.style.cssText=styleCommentData;if(p.cmts[0])t=p.cmts[0].data;else t="&nbsp;";f27(v2.div1,t);}  var atts=p.ptr.attributes;n=alist.getSize();for(var j=0;j<n;j++){t=alist.getAt(j);var ta=t.key.substr(0,3);var v2=v.f172(ta);if(ta=="xo_" && debugFlag==0 && xo_flag ==1){} else {q=p.ptr.attributes[j];att=p.ptr.getAttribute(t.key);if(att==null)tt="";else tt=att;var c1=v2.div1;c1.f207=v2;v2.rowIndex=i;var c2=f21("span");c2.style.cssText=styleNormalText;f27(c2,att);c2.node=p;c2.root=this;if(q){c2.changedName=q.nodeName;c2.f205=q;var c3=f21("div");c1.appendChild(c3);var mu=this.f106(q,c3,0,p);c3.appendChild(c2);c2.onblur=v1.onChange;c2.setAttribute("contentEditable","true");} if(t.key=="src" && p.ptr.nodeName=="img"){displayImgThumb(c1,att);}  } } n=nlist.getSize();for(j=0;j<n;j++){if(j==n-1)lastCol=1;else lastCol=0;t=nlist.getAt(j);q=p.getChildWithTagName(t.key);var v2=v.f172(q);v2.f206=1;v2.tdColSpan=1;var c1=v2.div1;c1.f207=v2;v2.rowIndex=i;if(q==null){v2.td.style.cssText=styleEmptyCell+f78(1,lastCol,lastRow,1);q="";} else {q.getChildren();q.hasIdenticalSib=1;k=this.groupIdenticalSiblings(q);if(k>1)v2.expandSiblings=1;if(q.attrs.length==0 && q.children.length==0 && q.cmts.length==0)v2.ptTagVal=1;this.f7(v2,0,1,lastRow,lastCol);v2.noArcs=1;} } /*if(n==0 && tagVal!=null)*/ if(n==0){var v2=v.f172(p);if(tagVal!=null)v2.ptTagVal=3;else v2.ptTagVal=3;v2.cmtPrinted=1;this.f7(v2,0,1,lastRow,1);} } f207.box2=b2;};this.groupIdenticalSiblings = function (q){var p,i,k,n,a;p=q.parent;if(!p)return 0;n=p.children.length;f19(q.parent);k=0;for(i=0;i<n;i++){a=p.children[i];if(a.ptr.nodeName==q.ptr.nodeName){k+=1;a.hasIdenticalSib=1;} } return k;};this.f15=function(){var a=this.node;var h=this.handle;var aa,i;var f206=this.f206;h.handle=this;if(this.f207!=null){if(this.f207.f206==1)this.root.f12(this.f207);else {this.root.f13(this.f207);} return false;} if(!a.ptr){aa=a.node.getAct();p=a.node.ptr;} else {p=a.ptr;aa=a.getAct();} if(aa=="expand"){serverRequestFlag=1;this.root.f12(a,h);} else {this.root.f13(a,h);} return false;};this.expandSiblings = function (f207,h){var b,parent,i,j,n;var r,c,txt;var myName;var a=f207.node;var sibs= new Array();var lastRow,lastCol;lastRow=0;lastCol=0;parent=a.parent;myName=a.ptr.nodeName;n=parent.children.length;j=0;for(i=0;i<n;i++){b=parent.children[i];if(b.ptr.nodeName==myName){b.holderVbox=f207;b.hasIdenticalSib=1;sibs[j++]=b;} } txt=myName+"("+sibs.length+")";this.f10(f207,txt);f207.f206=0;this.ptSiblings(sibs,f207);n=j;};this.ptSiblings = function(sibs,f207){var a,i,n,p,hasCmts;n=sibs.length;alist=new f30();nlist=new f30();hasCmts=0;for(i=0;i<n;i++){p=sibs[i];p.getChildren();p.nodes=sibs;} this.ctCompleteNodelist(0,sibs,alist,nlist);a=sibs[0];var holder = f21("td");a.ptSibling=1;var v2=f207.f173Style(a,"style1");this.f16(v2,0,alist,nlist);this.f158 (v2,sibs,null,alist,nlist,hasCmts);};this.f16 = function(f207,cellOffset,alist,nlist){var i,k,m,n,b,e,p,t;var c0,c1;var a=f207.node;var r=f207.row;r.style.verticalAlign="top";a.hrow=r;f17(r,cellOffset,0,1);f207.td.style.cssText="border-width: 0px;";k=0;m=alist.getSize()+nlist.getSize();if(a.hasCmt==1){var c=f25(r,60);c.style.cssText=styleCmtHeader;f18(c,"Comment");} n=alist.getSize();for(i=0;i<n;i++){t=alist.getAt(i);var tt=t.key.substr(0,3);if(tt=="xo_" && debugFlag==0 && xo_flag ==1){} else {var c=f25(r,60);if(k==m-1)c.style.cssText=f78(2,1,1,1);else c.style.cssText=f78(2,0,1,1);var ca=f21("span");var ck=f21("span");ck.style.cssText=styleAttributeHeader;ca.innerHTML="@";f18(ck,t.key);c.appendChild(ca);c.appendChild(ck);} k+=1;} n=nlist.getSize();for(i=0;i<n;i++){t=nlist.getAt(i);var c=f25(r,60);f18(c,t.key);c.style.cssText=styleNodeHeader;if(k==m-1)c.style.cssText+=f78(2,1,1,1);else c.style.cssText+=f78(2,0,1,1);} if(n==0){var c=f25(r,60);c.style.cssText=styleNodeHeader;c.style.cssText+=f78(1,0,1,0);} k+=1;};this.parse1 = function(a){var p,b,e,i,n;var v = new Array();b=a.ptr.childNodes;n=b.length;for(i=0;i<n;i++){e=b[i];switch(e.nodeType){case 1: v.push(e);break;case 3: break;} } return v;};this.drawArcs = function(as,mode){var a,b1,b2,i,n;n=as.length;if(this.mode==6)/* navigator mode */ return;for(i=0;i<n;i++){a=as[i];a.f165();} for(i=0;i<n;i++){a=as[i];a.f163(mode);} };this.f117 = function(f207,node){var e,v2;e=findChildNode(f207.node,node);if(e.group){v2=e.group.f207;this.f12(v2);} else this.f12(e.f207);return e.f207;};this.displayNode = function(g){var i,a,b,c,e;var v,v1,v2;var f207=rootVbox;i=g.getSize()-1;a=g.getAt(i);b=f207.node;v=f207.node.f207.box1.f207;this.f12(v);while(i>0){a=g.getAt(i--);v=this.f117(v,a);} v.div0.contentEditable="true";f62(v.row,"#BEF7EE");v.div0.focus();return;};this.ctFindFrm = function(){searchBox=f21("scan");menuBar.appendChild(searchBox);searchInput=f21("input");searchBox.appendChild(searchInput);searchInput.setAttribute("name",searchInput.id);searchInput.setAttribute("size",30);searchInput.focus();var f1=ctInputButton(this.doSearch,"Find","click to start searching");var f2=ctInputButton(this.hideSearchBox,"Cancel","close Find box.");searchBox.appendChild(f1);searchBox.appendChild(f2);searchBox.style.display="none";searchInput.setAttribute('title',"enter your search text here.");};this.doSearch = function(){var key=searchInput.value;if(key==""){alert("nothing to find out.");return;}  var r=v1.getFirstElement();gXPath="";gXPathNodes=new f29();var a=search(r,key);var x=gXPathNodes;if(gXPath==""){var t="'"+key+"' not found";alert(t);return;} v1.displayNode(x);a=gn;return;};this.showSearchBox = function(){searchBox.style.display="";searchInput.focus();};this.hideSearchBox = function(){searchBox.style.display="none";};};f1.prototype.f5 = function (f207){var a,e,i,j,m,n,co,h;var lastRow,lastCol,styleFlag;lastRow=0;lastCol=1;a=eval(f207.node);n=a.children.length;var g=f19(a);n=g.length;var v0=f207.f173Style(a,"style0",15);v0.row.parentNode.removeChild(v0.row);f207.td.style.cssText="border-width: 0px;";styleFlag=0;for(i=0;i<n;i++){if(i==n-1)lastRow=1;e=g[i];e.node.owner=a;e.node.n=e.n;var v=v0.f175(e.node);if(e.n>1){if(eval(a.hasIdenticalChildren)==1){e.node.state=1;e.node.act="collapse";/*e.node.htable=htable;*/this.f121(e);} else {v.node=e;v.iGroup=g;h=this.f6(v,lastRow);h.node=v.node.node;} } else {h=this.f7(v,1,0,lastRow,lastCol);styleFlag=1;} } if(styleFlag==1){var w=v.tb.parentNode;var hs=f21("style2");hs.appendChild(v.tb);w.parentNode.replaceChild(hs,w);} f207.box2=h;};f1.prototype.f121 = function(f207){var a,b,c,e,p,q,i,j,k,n,r,t,tt;var lastRow,lastCol;var alist,nlist,igroupMember;lastRow=0;lastCol=0;alist=new f30();nlist=new f30();e=f207.node;a=eval(e.node);if(!a)a=f207.node;var dad=a.parent;/*var g=f19(dad);igroupMember=findIdenticalNodeGroupMember(g,e);*/ igroupMember=e;if(igroupMember.start==null)igroupMember=f207;b=a.parent.children;for(i=igroupMember.start;i<=igroupMember.end;i++){p=b[i];p.getChildren();}  a.noSimplePopupMenu=1;a.n=f207.node.n;f207.node=a; if(a.children.length==0){this.f10(f207);} else {this.f7(f207,0,0);}   this.ctCompleteNodelist(igroupMember,b,alist,nlist);var tb=f21("table");var v2=f207.f173Style(a,"style1");this.f16(v2,0,alist,nlist);v2.node=igroupMember;this.f158(v2,b,tb,alist,nlist,a.hasCmt);f207.box2=v2.box2;f207.box1=f207.box1;};/*xsdGrid.js */ var gWorkDiv;var gColor1="#B0ABAB";var gColor2="";var gLineSize=1;var gGlobelElements = new Array();/* populated in f183()*/ var gSchemaNode;var gCmtsDivHeight;var gInputType="";var gParser;var gParm = new Object();function strToXsdGrid(xstr,gridid,onelevel,parentNode,mode){var t,xg;gParm.xstr =xstr;gParm.gridid=gridid;gParm.onelevel=onelevel;gParm.parentNode=parentNode;gParm.mode=mode;var parser = new f59();parser.f119(xstr);gParser=parser;var xmlDoc=parser.getDoc();docType=parser.getDocType();gInputType=docType;if(docType=="xslt"){xg=new xsltGrid(xmlDoc,gridid);} else if(docType=="xsd"){xg=new xsdGrid(xmlDoc,gridid);xg.setPrefix(parser.getPrefix());}  else {xg=new f1(xmlDoc,gridid);xg.setVersionStr(parser.versionStr());} if(onelevel==1)xg.setOneLevel(1);if(parentNode)xg.setParentNode(parentNode);xg.setMode(mode);xg.setRoot(xmlDoc);var d=document.getElementById(gridid);d.innerHTML="";xg.setHolderId(gridid);div=d;xg.dataTable = f21("table");var s1 = f21("span");div.appendChild(s1);s1.innerHTML=imgSequence;s1.style.display = "none";s1 = f21("span");div.appendChild(s1);f27(s1,imgChoice);s1.style.display = "none";setColor("green");/*link line color */ /*if(mBarId!=null)xg.setMuBarId(mBarId);*/ xg.init();return xg;};function xsdGrid(rt,gridid){var prefix;var root;root=rt;holderId=gridid;this.setPrefix=function(p){prefix=p;};this.prepName=function(e){var a=e.split(":");return a[1];};this.init = function(){var a,i,b,c;var f207;xTree=new xmlNode(0);var docnodes = root.childNodes;gRoot=root;var d=document.getElementById(holderId);rootHolder=d;a=docnodes[0];b=a.nodeName;if(b=="parsererror"){d.textContent=a.textContent;return;} arcs=new Array();this.dataTable.style.cssText=styleGridTable;var r=f112(this.dataTable);var td=f25(r,90);f207=new f171(td,a);f207.f206=1;f207.tb=this.dataTable;d.oncontextmenu = this.disableEvent;d.onclick = f136;document.onkeydown=f137;menuBar=f21("div");inputHeadBox=f21("div");gMu=new Object();dirtyList=new f30();gWorkElemList=new f30();dn = new dirtyNodes(menuBar,dirtyList,root);f27(menuBar,"");d.appendChild(menuBar);d.appendChild(inputHeadBox);gridView=f21("div");textView=f21("div");d.appendChild(textView);d.appendChild(gridView);gridView.appendChild(this.dataTable);if(this.mode!=6){var rh=ctCmdIcon(this.reloadSource,imgReload,"Rebuild node tree from the casched XML source.");menuBar.appendChild(rh);var vh=ctInputButton(this.f315View,"TextView","change display view");menuBar.appendChild(vh);vh.img0="GridView";vh.i=0;vh.gridView=gridView;vh.textView=textView;vh.textViewCreated=0;vh.lineMode=1;} this.ptInputHead(f207);this.ptDoc(f207,docnodes);rootVbox=f207;return;};this.f13=function(f207){var a,r,div0,div1;a=f207.node;div1 = f21("div");f207.f178=f207.div1;f207.div1.parentNode.replaceChild(div1,f207.div1);f207.div1=div1;f315H(f207.parent.childRow,0);f207.div1=div1;f207.f206=1;var box2=this.f186(f207);if(f207.box1){f611(f207.box1.boxRight,box2);f207.div1.focus();} this.drawArcs(arcs);};this.f12 = function(f207){var a,f,typ;var typeName;a=f207.node;typ=eval(a.ptr);typeName=this.prepName(typ.nodeName);if(typeName=="schema"){this.f183(f207);return;}  if(eval(f207.f178)!=null)/*use the previous expaned node,save a lot of work */ {f207.div1.parentNode.replaceChild(f207.f178,f207.div1);f207.div1=f207.f178;f315H(f207.parent.childRow,1);f207.f206=0;this.drawArcs(arcs);} else {var holder = f207.div1;this.f155(f207);if(f207.box1)f207.box1.focus();this.drawArcs(arcs,holder);} };this.f183 = function(f2070){var a,td,t,c0,c1,i,j,n,p,r,typ,elName;var ref,b;a=f2070.node;elName=eval(a.ptr).getAttribute("name");if(f2070.keepArcs==1){} else arcs=new Array();var holder=f21("div");holder.style.cssText=styleDataTableHolder;a.getChildren();gSchemaNode = a;td=f2070.td;this.f8(a,f2070,f2070.div1);n=a.children.length;for(j=0;j<n;j++){b=eval(a.children[j]);var f207=f2070.f173(b);f207.f206=1;f207.showNodeName=1;this.f186(f207);gGlobelElements.push(b);} n=gGlobelElements.length;var atts=a.ptr.attributes;n=atts.length;for(j=0;j<n;j++){att=atts[j];t=att.nodeName;t=att.nodeValue;} gWorkDiv=f21("div");};this.f113 = function(p,f207,expandFlag){var a=p.node;documentChanged();f207.td.style.cssText=styleInerGridTable;var div1=f21("div");f207.div1.parentNode.replaceChild(div1,f207.div1);f207.div1=div1;f207.keepArcs=1;this.f12(f207);this.drawArcs(arcs);};this.deleteAnnotation = function (){var p=this.node;var t=p.node.ptr;t.parentNode.removeChild(t);var f207=p.f207;var div1=f21("div");f207.div1.parentNode.replaceChild(div1,f207.div1);p.root.drawArcs(arcs);};/*this.editAnnotation = function(){var t,info;var c=this;var p=this.node;var a=p.owner;var f207=p.displayHandle.f207;t="Edit Annotation";info="Node: "+a.ptr.nodeName;if(gFrm)gFrm.close();gFrm=new f72(f207.div1,t,info,p);gFrm.f71(p.root.doEditAnnotation);tmpValId=gFrm.addTextarea("Annotation",p.data,50,3);gFrm.init();a.form=gFrm;};*/ this.editAnnotation = function(){var t,info;var c=this;var p=this.node;var h=p.displayHandle.f207.div1;/*p.displayHandle.setAttribute("contentEditable","true");*/ h.setAttribute("contentEditable","true");h.oncontextmenu=null;h.savedStyle=h.style.cssText;h.style.cssText=styleXsdAnnotationEditBox;h.onblur=p.root.doEditAnnotation;};/* this.doEditAnnotation = function(fm,node){var b,t,info,old;var f207=eval(node.f207);old=node.data.valueOf();t=document.getElementById(tmpValId).value;var a=f207.node.getChildWithTagName("xs:annotation");node.root.updateAnnotation(a,t);node.root.f185(f207);node.owner.form=null;documentChanged();node.root.drawArcs(arcs);return;};*/ this.doEditAnnotation = function(){var b,t,info,old,node;var f207=eval(this.f207);var h=eval(f207.div1);h.setAttribute("contentEditable","false");t=f207.div1.childNodes[0];var val=getNodeValue(t);node=this.node;var a=f207.node.getChildWithTagName("xs:annotation");updateNodeValue(node,val);f207.node.root.f185(f207);documentChanged();f207.node.root.drawArcs(arcs);return;};this.ctAnnotationMenu = function(txt,f207,d){var mu=new f39(d);var a=f207.node;var p =new Object();p.node=d.node;p.owner=a;p.data=txt;p.root=this;p.displayHandle=d;p.f207=f207;mu.f70("Edit Annotation",this.editAnnotation,p);mu.f70("Delete Annotation",this.deleteAnnotation,p);mu.init();return mu;};this.f185 = function(f207){var a,c,aa,t,txt;var a=f207.node;if(a.ref!=null)aa=a.ref;else aa=a;aa.reset();aa.getChildren();t=aa.getChildWithTagName("xs:annotation");if(t==null)return;txt=getNodeValue(t.ptr);if(txt==null)return;txt=leftTrim(txt);txt=rightTrim(txt);c=f207.div1;eval(c.style).cssText=styleXsdAnnotationBox;f27(c,txt);c.f205=t.ptr;c.node=t;c.f207=f207;var mu=this.ctAnnotationMenu(txt,f207,c);c.oncontextmenu=mu.showMenu;};this.f186 = function (f207){var a,td,showNodeName;var g = f207.div1;a=f207.node;var c0,c1,c2,p,elName;var x,minOccurs,maxOccurs;var act;minOccurs=1;c1=f21("div");c1.style.cssText=styleXsdNodeTypeLabel;c0=f21("div");f207.f179=c0;c0.style.cssText=styleXsdNodeHolder;c2=f21("div");g.appendChild(c0);c0.appendChild(c2);p=eval(a.ptr);if(f207.showNodeName==1){f27(c1,p.nodeName);c0.appendChild(c1);} x=p.getAttribute("minOccurs");if(x!=null){minOccurs=parseFloat(x);} a.minOccurs=minOccurs;maxOccurs=p.getAttribute("maxOccurs");if(maxOccurs!=null)a.maxOccurs=maxOccurs;var ref=p.getAttribute("ref");if(ref!=null){f27(c1,"ref");c0.appendChild(c1);elName=eval(a.ref.ptr).getAttribute("name");} else elName=eval(a.ptr).getAttribute("name");c0.appendChild(c2);act=this.f156(f207,c2,elName,f207.f206,f207.box1,f207.showNodeName,g);var c3=f21("div");c0.appendChild(c3);/* c0.boxRight=c2.boxRight;eval(c3.style).cssText=styleXsdAnnotationBox;this.f185(a,c3);*/  var v=f207.childBox(a,c3);this.f185(v);return c0;};this.f187 = function (a,f207){var c0,c1,c2,p,elName;var x,minOccurs;var act;minOccurs=0;c0=f21("div");c2=f21("div");f207.div1.appendChild(c0);c0.appendChild(c2);p=eval(a.ptr);x=p.getAttribute("use");if(x && x=="required"){minOccurs=1;} a.minOccurs=minOccurs;elName=eval(a.ptr).getAttribute("name");if(f207.node.n==null)f207.node.n=0;this.f156(f207,f207.div1,elName);c0.boxRight=c2.boxRight;var c3=f21("div");f207.div1.appendChild(c3);eval(c3.style).cssText=styleXsdAnnotationBox;var v=f207.childBox(a,c3);this.f185(v);return c0;};/*this.expandComplexType = function(a,td){var e,ref,box1;ref=eval(a.ptr).getAttribute("ref");if(ref==null){return;} td.htd=td0.parentNode;e=this.f151(a,td,null);var b,typ,r;var box1,box2;a.getChildren();b=eval(a.children[0]);typ=eval(b.ptr).nodeName;r=f112(htable);r.style.cssText=styleXsdNodeHeadTd;typ=this.prepName(typ);if(typ=="sequence"){box2=this.f182(b,r,"Sequence");} else if(typ=="choice"){box2=this.f182(b,r,"Choice");} };*/   this.f188 = function(a,alist){var i,n,b,typ;var key;n=a.children.length;for(i=0;i<n;i++){b=a.children[i];typ=eval(b.ptr).nodeName;if(typ=="xs:attribute"){key=b.ptr.getAttribute("name");alist.add(key,b);} } };this.expandAttrs = function(){var i,n,icon,q;var f207=this.f207;var alist=eval(this.node);var f206;var a,r,tb,td,box1,box2;/* tb=f21("table");r=f112(tb);var c=f25(r,60);*/ var t=f21("div");f207.div1.parentNode.replaceChild(t,f207.div1);var v1 = f207.childBox(alist,t);if(v1.f206==1){v1.f206=0;icon=imgArrowUp;} else {v1.f206=1;icon=imgArrowDown;} horizontalSpacer(v1.div1);box2=this.root.f157(alist,v1,icon,f206);f611(v1.box1.boxRight,box2);horizontalSpacer(v1.div1);n=alist.getSize();if(v1.f206==1 || n<1){this.root.drawArcs(arcs);return false;} t.style.cssText=styleXsdAttrsHolder;var box3;for(i=0;i<n;i++){a=alist.getAt(i).val;var v2=v1.childBox(a);v2.f206=1;horizontalSpacer(v2.div1);box3=this.root.f187(a,v2);} this.root.drawArcs(arcs);return false;};this.f157 = function(alist,f207,icon,box1,htd){var hCmd;var f206,showNodeName;var t0=f21("span");var t1=f21("span");f207.div1.appendChild(t0);var root=this;hCmd = createCmdButton(alist,f207,icon,this.expandAttrs,styleXsdNodeIconBox,root);eval(t0.style).cssText=styleXsdAttrHeadBox;var n=alist.getSize();if(n>0)var s="Attributes("+n+")";else var s="Attributes";f27(t1,s);t0.appendChild(hCmd);t0.appendChild(t1);return hCmd;};this.f152 = function(f207){var i,m,n,typ,box2,p,q;var alist=new f30();var tb=eval(f207.tb);var hr=eval(f207.row);var aa=eval(f207.node);if(aa!=null){p=eval(aa.ptr);aa.getChildren();this.f188 (aa,alist);m=alist.getSize();n=aa.children.length;} else return;var nodeName=this.prepName(p.nodeName);if(nodeName=="attributeGroup"){this.f181(f207);return;} else if(nodeName=="complexContent"){} if(m>0 && nodeName!="attributeGroup")/* has attribtes */ {if(hr==null){hr=f112(tb);}  var v1=f207.f173(alist);box2=this.f157(alist,v1,imgArrowDown);f611(v1.box1.boxRight,box2);f207.f177();} hr.style.cssText=styleXsdNodeHeadTd;for(i=0;i<n;i++){b=aa.children[i];f207.node=b;typ=eval(b.ptr).nodeName;typ=this.prepName(typ);var ref=eval(b.ptr).getAttribute("ref");if(ref!=null){b.ref=gSchemaNode.getChildWithAttribute("name",ref);}  if(typ=="annotation"){} else if(typ=="attribute")/* do nothing */ {} else if(typ=="sequence"){box2=this.f182(f207,"Sequence");f611(f207.box1.boxRight,box2);} else if(typ=="choice"){box2=this.f182(f207,"Choice");f611(f207.box1.boxRight,box2);} else if(typ=="complexType"){box2=this.f152 (f207);f611(f207.box1.boxRight,box2);} else if(typ=="complexContent"){box2=this.f193(f207);f611(f207.box1.boxRight,box2);}  else if(typ=="extension"){box2=this.f195(f207);f611(f207.box1.boxRight,box2);} else if(typ=="restriction"){box2=this.f153(f207);f611(f207.box1.boxRight,box2);} else if(typ=="attributeGroup"){box2=this.f186(f207);f611(f207.box1.boxRight,box2);} else {box2=this.f186(f207);f611(f207.box1.boxRight,box2);}  } return box2;};this.ptAttributes = function (b,c,displayStyle){var i,a,s,holder;var alist=b.ptr.attributes;var n=alist.length;if(displayStyle!=null){holder=f21("div");holder.style.cssText=styleXsdAttrsHolder;c.appendChild(holder);} else holder=c;for(i=0;i<n;i++){a=alist[i];s=a.nodeName+": \n "+a.nodeValue;var c3=f21("div");holder.appendChild(c3);f27(c3,s);} return holder;};this.f189 = function(f207){var txt,b;b=f207.node;if(IE){txt=b.ptr.innerHTML;} else txt=b.ptr.textContent;if(txt==null)return;var c3=f21("div");f207.div1.appendChild(c3);f27(c3,txt);this.ptAttributes(b,f207.div1);};this.f191 = function(f207){var r,aa,t,c0,c1,i,j,n,typ,elName,tb,td;var type;var ref,b;var box1,box2,q;var a=f207.node;elName=eval(a.ptr).getAttribute("name");e=this.f151(f207);a.getChildren();n=a.children.length;if(n<1)return;var td3=f25(f207.row,270);var c3=f21("div");eval(c3.style).cssText=styleXsdAnnotationNodeBox;td3.appendChild(c3);var v1=f207.childBox(a,c3);for(i=0;i<n;i++){b=a.children[i];typ=eval(b.ptr).nodeName;v1.node=b;if(typ=="xs:documentation"){this.f189(v1);} } f611(v1.box1.boxRight,v1.div1);};this.f192= function(f207){var a,t,c0,c1,i,j,n,typ,elName,tb,td;var type;a=f207.node;elName=eval(a.ptr).getAttribute("name");e=this.f151(f207);};this.f193= function(f207){var box1,box2,q;var a=f207.node;box1=f207.box2;this.f152(f207);elName=eval(a.ptr).getAttribute("name");};this.f195 = function(f207){var aa,b,typ,box1,box2,q;var a=f207.node;box1=f207.box2;var base=eval(a.ptr).getAttribute("base");aa=f198(base,1);a.getChildren();var n=a.children.length;if(n<1)return;var v1=f207.f173(aa);c1=f21("div");c1.style.cssText=styleXsdReferencedTypeLable;v1.div1.appendChild(c1);v1.div1.style.cssText=styleXsdReferencedTypeBox;f27(c1,base+"(extention)");v1.f177();this.f152(v1);f207.f177();this.f152(f207);};this.f153= function(f207){var b,typ,box1,box2,q;var a=f207.node;box1=f207.box2;var base=eval(a.ptr).getAttribute("base");a.getChildren();var n=a.children.length;if(n<1)return;var v1=f207;println(a.ptr.nodeName,v1.div1,styleLabel1,"");this.ptAttributes(a,v1.div1);for(i=0;i<n;i++){b=a.children[i];typ=eval(b.ptr).nodeName;this.ptAttributes (b,v1.div1);} elName=eval(a.ptr).getAttribute("name");};this.f181= function(f207){var r,aa,t,c0,c1,i,j,n,typ,elName,tb,td;var type;var ref,b;var box1,box2,q;var a=f207.node;box1=f207.box2;elName=eval(a.ptr).getAttribute("name");if(a.ref){aa=eval(a.ref);a=aa;}  a.getChildren();n=a.children.length;if(n<1)return;r=f207.row;var td3=f25(r,170);var c3=f21("div");eval(c3.style).cssText=styleXsdAttributeGroupBox;td3.appendChild(c3);tb=f21("table");c3.appendChild(tb);r=f112(tb);var border=f78(1,0,1,1);ctTextCell(r,"name",styleLabel1,border);border=f78(1,0,1,1);ctTextCell(r,"use",styleLabel1,border);border=f78(1,0,1,1);ctTextCell(r,"type",styleLabel1,border);border=f78(1,1,1,1);ctTextCell(r,"default",styleLabel1,border);var top,right,bot,left;for(i=0;i<n;i++){top=1;bot=0;if(i==0)top=0;else if(i==n-1){bot=1;}  b=a.children[i];r=f112(tb);t=eval(b.ptr).getAttribute("name");border=f78(top,1,bot,1);ctTextCell(r,t,styleNormalText,border);t=eval(b.ptr).getAttribute("use");border=f78(top,1,bot,0);ctTextCell(r,t,styleNormalText,border);t=eval(b.ptr).getAttribute("type");border=f78(top,1,bot,0);ctTextCell(r,t,styleNormalText,border);t=eval(b.ptr).getAttribute("default");border=f78(top,1,bot,0);ctTextCell(r,t,styleNormalText,border);typ=eval(b.ptr).nodeName;if(typ=="xs:attribute"){} } f611(f207.box1.boxRight,td3);return box1;};this.f151 = function (f207){var v2;var a=f207.node;v2=f207.f175(a);var d=v2.div1;f207.f179.parentNode.replaceChild(d,f207.f179);v2.row.style.cssText=styleXsdNodeHeadTd;if(f207.f206==1)v2.f206=0;else v2.f206=1;this.f186(v2);f207.box1=v2.box2;v2.td.style.cssText=styleXsdNodeHeadTd;};this.f197 = function(f207){var e,aa,t,c0,c1,i,j,n,typ,elName,tb,td;var type;var ref,b;var box1,box2,q;var a=f207.node;elName=eval(a.ptr).getAttribute("name");ref=eval(a.ptr).getAttribute("ref");aa=a;if(ref!=null){a.ref=f198(ref,1);aa=a.ref;} this.f151(f207);var v2=f207.f172(aa);v2.f177();v2.f206=f207.f206;type=eval(a.ptr).getAttribute("type");if(type!=null){var q=type.substring(0,3);if(q=="xs:"){var displayStyle=1;box2=this.ptAttributes(aa,v2.div1,displayStyle);f611(v2.box1.boxRight,box2);} else {c1=f21("div");c1.style.cssText=styleXsdReferencedTypeLable;f27(c1,type);v2.div1.appendChild(c1);aa=gSchemaNode.getChildWithAttribute("name",type);v2.node=aa;v2.div1.style.cssText=styleXsdReferencedTypeBox;v2.f177();} } box2=this.f152(v2);f207.childRow=v2.row;return f207.box1;};this.f182 = function(f207,xsType){var act,b,c,c1,c2,tb,p,td;var box1,box2;var i,n;var elName;var a=f207.node;if(f207.noNewTd==1)c=eval(f207.div1);else {c=f25(f207.row,90);eval(c.style).cssText=styleXsdSequenceTd;} c1=f21("img");c.appendChild(c1);if(xsType=="Sequence"){c1.setAttribute('src',imgSequenceSrc);c1.setAttribute('alt','Sequence');} else if(xsType=="Choice"){c1.setAttribute('src',imgChoiceSrc);c1.setAttribute('alt','Choice');}  box1=c1;box1.boxRight=c1;c=f25(f207.row,90);tb=f21("table");c.appendChild(tb);a.getChildren();n=a.children.length;for(i=0;i<n;i++){b=a.children[i];var r=f112(tb);td=f25(r,120);td.style.cssText=styleXsdSequenceTd;c2=f21("span");var v2=new  f171(td,b,f207);v2.f206=1;v2.box1=box1;v2.row=r;typ=eval(b.ptr).nodeName;typ=this.prepName(typ);if(typ=="annotation"){} else if(typ=="element"){var ref=eval(b.ptr).getAttribute("ref");if(ref!=null){b.ref=f198(ref,1);} box2=this.f186(v2);f611(box1,v2.box2);f207.box2=v2.box2;} } return box1;};this.f156 = function(f207,c,nname){var a,act,holder,u,t,t0,p;var myName;var txt;var f206;a=eval(f207.node);f206=eval(f207.f206);if(!eval(a.ptr)){p=a.node.ptr;} else {p=a.ptr;} myName=nname ? nname: p.nodeName;holder = f21("div");c.appendChild(holder);txt=myName;if(a!=null){if(a.n>1)txt+="("+a.n+")";} var h0=f21("span");if(a.maxOccurs=="unbounded")h0.style.cssText=styleXsdNodeHolderShade;var sty;if(a.minOccurs==0)sty=styleXsdNodeHeadBox+"border-style: dotted;";else sty=styleXsdNodeHeadBox+"border-style: solid;";holder.appendChild(h0);var h1=f21("span");h1.style.cssText=sty;h0.appendChild(h1);var nameH=f21("span");h1.appendChild(nameH);f27(nameH,txt);var img,info;info="";if(f206==1){img=imgArrowRight;img=imgPlusGif } else {img=imgArrowLeft;img=imgMinusGif } t=ctCmdIcon(this.f15,img,info,a);t.handle=f207.div1;t.root=this;t.f207=f207;f207.box2=c;c.boxRight=t;h1.appendChild(t);holder.root=this;f207.nameH=nameH;nameH.node=a;a.f207=f207;a.root=this;this.f106(a,holder);/* if(a.ptr!=null && a.noSimplePopupMenu==0){if(a.f199!=null){var mu=a.mu;var h1=mu.getHolder();holder.appendChild(h1);holder.oncontextmenu=mu.showMenu;} else {this.f106(a,holder);a.nodeNameHandle=t;} } */ return 1;};this.f155= function(f207){var co,i,j,n,box1,box2;var a=f207.node;var p=eval(a.ptr);if(eval(f207.box1)!=null)box1=eval(f207.box1).boxRight;var typeName=this.prepName(p.nodeName);if(typeName=="element"){box2=this.f197(f207);} else if(typeName=="complexType"){box2=this.f197(f207);} else if(typeName=="complexContent"){this.f197(f207);}  else if(typeName=="simpleType"){this.f197(f207);/* this.f192(f207);*/ } else if(typeName=="annotation"){this.f191(f207);} else if(typeName=="attributeGroup"){box2=this.f197(f207);} if(box1 && box2){f611(box1,box2);} };this.processDocumentType = function(a,htable){};this.f2=function(f207,htable,hrow,cellOffset,lastRow){var a,co,i,j,n,nType;a=f207.node;var p=eval(a.ptr);if(cellOffset==null)co=a.level;else co=cellOffset;if(p.nodeType==10){this.processDocumentType(a,htable);} else if(p.nodeType==8){this.doOneCmt(a,p,f207);} else if(p.nodeName=="xs:schema"){this.f183(f207);return htable;} };this.f106 = function(a,holder){var b,h2;var p=a.ptr;var at=a.ptr.nodeType;var nodeName=a.ptr.nodeName;var mu=new f39(holder,0,h2);a.mu=mu;mu.f70("Show XML Source Code",this.showXmlSrc,p);nodeName=this.prepName(nodeName);if(nodeName=="element"){var node2=new Object();node2.a=a;node2.subMenuGroup="add";/* mu.f70("Add",0,node2,this.ctAddSubMenu);*/ } /* mu.f70("Edit Name",this.editName,a);*/ mu.init();holder.oncontextmenu=mu.showMenu;return mu;};this.ctAddSubMenu = function(c){var p=new Object();var i;p.node=c.node;p.root=c.root;var a=p.node.a;var holder = f21("span");var mu=new f39(holder,100);var b=a.ptr.getElementsByTagName("xs:complexType")[0];if(b==null){mu.f70("Sequence",c.root.addSequence,p);mu.f70("Choice",c.root.addChoice,p);i=0;}  mu.f70("Comment",c.root.insertCmt,p);mu.f70("Attribute",c.root.insertAttribute,p);p.insertChild=0;mu.init();holder.oncontextmenu=mu.showMenu;c.appendChild(holder);c.subMenu=mu;};this.addComplexElement = function (a,f207,typ){var c=gRoot.createElement("xs:complexType");var newNode = gRoot.createElement(typ);c.appendChild(newNode);a.ptr.appendChild(c);a.reset();a.getChildren();a.root.f12(f207);};this.addSequence = function(){var a=this.node.node.a;a.root.addComplexElement(a,a.f207,"xs:sequence");};this.addChoice = function(){var a=this.node.node.a;a.root.addComplexElement(a,a.f207,"xs:choice");};this.editName = function(){var a=this.node;var nameH=a.f207.nameH;nameH.setAttribute("contentEditable","true");nameH.savedStyle=nameH.style["backgroundColor"];if(nameH.savedStyle==null)nameH.savedStyle=nameH.style.cssText;nameH.style["backgroundColor"]=styleHighlightBkColor;nameH.onblur=a.root.doEditName;return;};this.doEditName = function(ev){ev = (ev)? ev : window.event;var k=getKey(ev);var a=this.node;var nameH=a.f207.nameH;var old=a.ptr.getAttribute("name");if(IE){a.ptr.innerHTML=nameH.innerHTML;} else a.ptr.setAttribute("name",nameH.textContent);nameH.setAttribute("contentEditable","false");nameH.onblur=null;nameH.style.cssText=nameH.savedStyle;};this.ctSubMenu = function(c){var p=new Object();p.node=c.node;p.root=c.root;var holder = f21("span");var mu=new f39(holder,100);if(c.node.subMenuGroup=="edit"){mu.f70("Name",c.root.insertCmt,p);} else if(c.node.subMenuGroup=="add"){mu.f70("Comment",c.root.insertCmt,p);mu.f70("Attribute",c.root.insertAttribute,p);p.insertChild=0;if(c.node.tagValue==null)mu.f70("Node Value",c.root.f65Value,p);if(c.node.parent!=null)mu.f70("Sibling Node",c.root.f65,p);p=new Object();p.node=c.node;p.root=c.root;p.insertChild=1;mu.f70("Child Node",c.root.f65,p);} mu.init();holder.oncontextmenu=mu.showMenu;c.appendChild(holder);c.subMenu=mu;};};function createCmdButton(node,f207,icon,callBackFn,cssText,root){var c;var t0=f21("span");var t=f21("span");t0.appendChild(t);f207.Holder=t0;t.style.cssText=cssText;t0.f207=f207;t0.node=node;var u="<a href=\"\"> ";f27(t,u+icon+"</a>");t0.onclick= callBackFn;t0.f206=f207.f206;t0.root=root;return t0;};function f198(name,option){var a=gSchemaNode.getChildWithAttribute("name",name);if(!a && option==1){var q=name.substring(3,99);a=gSchemaNode.getChildWithAttribute("name",q);} return a;};xsdGrid.prototype = new f1;/*xsltGrid.js */ function xsltGrid(rt,gridid){this.f5 = function (f207,a,htable){var e,i,j,m,n,co,h;var lastRow,lastCol,styleFlag;lastRow=0;lastCol=1;a=f207.node;n=a.children.length;var v0=f207.f173Style(a,"style0",15);v0.row.parentNode.removeChild(v0.row);f207.td.style.cssText="border-width: 0px;";styleFlag=0;for(i=0;i<n;i++){if(i==n-1)lastRow=1;e=a.children[i];e.owner=a;e.n=1;var v=v0.f175(e);{h=this.f7(v,0,1,0,lastRow,lastCol);styleFlag=1;} } if(styleFlag==1){var w=v.tb.parentNode;var hs=f21("style2");hs.appendChild(v.tb);w.parentNode.replaceChild(hs,w);} f207.box2=h;};this.f121 = function(f207){var a;/*if(!(f207.nodeName && f207.nodeName=="xsl:template"))*/ {f1.prototype.f121.call(this,f207);return;} };};xsltGrid.prototype = new f1;xsltGrid.prototype.constructor = xsltGrid;/* fileMenu_uncompressed.js */ var newNodeId;var newFileNameId;var fileObjectId;var textObjectId;var inputObjectId;var styleInputBoxTable="";var styleInputBoxFieldLabel="";var hGridId;var gValue="lwh";var valCode=0;var g_mode=0;/*0: f1;editor 2: f1 viewer;9: csvToXml;*/  function createFileMenu(hid,hMid){var h=document.getElementById(hMid);if(h==null)return;hGridId=hid;/* f39 f39 f70 f70 */ var mu=new f39(h,70);mu.f70("New File",callCreateNewFile,0,null,1);mu.f70("Open File",callOpenFile,0,null,1);mu.f70("Input Box",callInputBox,0,null,1);gSaveFileMu=mu.f70("Save",saveFile);gSaveFileMu.style.cssText=styleGrayedText;mu.init();return mu;};function callCreateNewFile(){var hid,note;hid= hGridId;createNewFile(hid);};function createNewFile(hid){var frm;var bt=browserType();var handle = document.getElementById(hid);handle.innerHTML ="";/* f72(handle,title,info,ptr)f72  f61 f61 f71 f71 */ if(typeof f72 == 'function'){frm=new f72(handle,"New XML File",null,0,1);frm.setFrmStyleClass("filefrm");frm.init();newFileNameId=frm.f61("File Name",0);newNodeId=frm.f61("Root Node Name",0,30,1);frm.f71(doNewFile);} else {frm=new f72(handle,"New XML File");newFileNameId=frm.f61("File Name",0);newNodeId=frm.f61("Root Node Name",0,30,1);frm.f71(doNewFile);} frm.showForm();};function callInputBox(){var hid,note;hid= hGridId;inputBox(hid);};function byUrlBox(hid){var s;var info;var i;var h;if(!hid)h="content";else h=hid;hGridId=h; var handle = document.getElementById(h);var platform=navigator.platform;info="<b>Read XML data from internet</b> (XML,XSLT,XSL,XSD,HTML,XHTML).";handle.innerHTML ="";var hTableCssText="border-collapse: collapse;";var frm=new f72(handle,null,info,0,2,1,"",hTableCssText);inputObjectId=frm.f61(" URL ","",70,1);frm.setOkText("Submit");frm.init();frm.f71(doByUrlBox);frm.setCancelCallback(doCancelByUrl);frm.showForm();ptHelp(handle,6);var t="~pf="+navigator.platform+"~bt="+browserType();t+="~cmd=byUrlBox";clientInfo(t);if(g_mainScript==false)return;var url=g_mainScript;if(url==null)return;var obj=new Object();obj.callBack=ajaxCallback;url+="?mu=ajax&task=valCodeRquest&str="+"&l="+Math.random();;obj.target=hGridId;ajaxInterface(url,"GET",ajaxCallback,obj);return;};function inputBox(hid){var s;var info;var i;var h;if(!hid)h="content";else h=hid;hGridId=h; var handle = document.getElementById(h);var platform=navigator.platform;info="<b>Enter XML data in this Text Input Box </b> (XML,XSLT,XSL,XSD,HTML,XHTML).";/*info="Platform: "+platform;*/ if(platform=="Linux x86_64")i=30;else i=38;handle.innerHTML ="";var hTableCssText="border-collapse: collapse;";var frm=new f72(handle,null,info,0,2,1,"",hTableCssText);/*addTextarea = function(label,text,width,height)*/ var labelRowFlag=1;textObjectId=frm.addTextarea(null,null,110,8,labelRowFlag);frm.setOkText("Submit");frm.init();frm.f71(doInputBox);frm.showForm();ptHelp(handle,99);var t="~pf="+navigator.platform+"~bt="+browserType();t+="~cmd=inputBox";clientInfo(t);return;};function callOpenFile(){var hid,note;hid= hGridId;note="";openFile(hid,note);};function openFile(hid,note){var s;var bt=browserType();var t="~pf="+navigator.platform+"~bt="+browserType();t+="~cmd=openFile";clientInfo(t);if(bt=="FF3"){createOpenFileFrm(hid,note);return;} createOpenFileFrmSrv(hid,note);/* if(bt=="FF3" || bt=="MSIE")s=g_mainScript+"?&mu=openFile&bt="+bt+"&platform="+navigator.platform+"&l="+Math.random();document.location.href=s;*/  };function saveFile(){var s,me;if(gSaveFileFlag==0)return;gSaveFileMu=this;gSaveFileMu.style.cssText=styleGrayedText;gSaveFileFlag=0;dn.updateDoc();return;};function createOpenFileFrm(hid,note){var info;var i;if(!hid)hGridId="content";else hGridId=hid;var handle = document.getElementById(hGridId);var platform=navigator.platform;info="Platform: "+platform +" "+browserType();if(platform=="Linux x86_64")i=28;else i=38;handle.innerHTML ="";/*var frm=new f72(handle,"Open File (supported type: xml,xsd,xsl,xslt,html,xhtml,prj)",info,0,1);*/ var frm=new f72(handle,note,info,0,1);frm.setFrmStyleClass("filefrm");frm.setPtCancelButton(0);frm.setOkText("Submit");if(g_mainScript==null)g_mainScript="";frm.setAction(g_mainScript);frm.init();fileObjectId=frm.addFilePrompt("File Name",i,note);frm.f71(doOpenFile);frm.showForm();var w=document.getElementById(fileObjectId);var f1=frm.getForm();var f = document.getElementById(fileObjectId);f.onchange=doOpenFile;/*w.setFocusField();*/  return;};function ieReadFile(filename){try     {var fso  = new ActiveXObject("Scripting.FileSystemObject");var fh = fso.OpenTextFile(filename,1);var contents = fh.ReadAll();fh.Close();return contents;}     catch (Exception){var s="Cannot open file: "+filename;var handle = document.getElementById("content");handle.innerHTML =s;return 0;} };function readOneFile(e){gValue = e.target.result;};function fileReadErr(e){var err=e;alert("fileReadErr");};function handleReaderProgress(evt){if (evt.lengthComputable){var loaded = (evt.loaded / evt.total);$("#progressbar").progressbar({value: loaded * 100 });} };function chromeReadFile(f){var s;var frm=gZform.getForm();frm.submit();return false;var reader = new FileReader();reader.onprogress = handleReaderProgress;reader.onload = readOneFile;reader.onerror = fileReadErr;reader.onloadend = readOneFile;reader.readAsDataURL(f);/*  reader.readAsText(f);*/  s=gValue;};function doOpenFile(){var filename,filesize;var xstr;var bt=browserType();var f = document.getElementById(fileObjectId);filename=f.value;if(bt=="MSIE"){xstr = ieReadFile(filename);} else if(bt=="Chrome"){xstr = chromeReadFile(f.files[0]);return;} else if(f.files){var myfile = f.files[0];var reader = new FileReader();reader.readAsText(myfile);alert("Reading "+filename+"...");xstr=reader.result;filesize = myfile.size;} if(xstr==0)return false;processOneFile(xstr,filename,filesize);return false;};function doInputBox(){var f = document.getElementById(textObjectId);var text=getNodeValue(f);processOneFile(text,"null",88);return false;};function doByUrlBox(){var f = document.getElementById(inputObjectId);var fileAddr=f.value;var obj=new Object();obj.addr=fileAddr;var str="&str=~mu=getFileByUrl~bt="+browserType()+"~platform="+navigator.platform+"~url="+fileAddr+"~v="+valCode;obj.url=g_mainScript+"?mu=ajax"+"&task=genericCall"+str+"&l="+Math.random();obj.target=hGridId;obj.callBack=ajaxCallback;var h = document.getElementById(hGridId);h.innerHTML="<br><br>Getting "+fileAddr+"...<br>Please wait.<br><br>";/* h.style.cssText = "padding: 25px 9px 25px 5px;border-width: 1px 0px 1px 0px;font-size:12px;color:blue;";*/ h.style.cssText="font-family: Verdana,Arial,'Microsoft Sans Serif';font-size:11px;";makeAjaxRequest(obj);return false;};function processOneFile(xstr,filename,filesize){var handle = document.getElementById(hGridId);var n=eval(xstr.length);var helpId; if(n<1){alert("input empty.");return;}  var s="<span class=>";s+="<span class=boldText>Source: </span>" + filename;s+=" &nbsp;&nbsp;<br><span class=boldText>File Size: </span>" + n;s+="</span><br>";handle.innerHTML =s; var mode=0;if(g_mode)mode=g_mode;switch(mode){case 0: helpId=5;break;case 2: helpId=8;break;case 9: helpId=9;break;}   if(mode==8)var x=strToXml(hGridId,xstr);else if(mode==6)var x=loadSourceCmd(null,xstr,hGridId);else if(mode==7)var x=loadSourceCmd07(null,xstr,hGridId);else if(mode==12)/*gen Xml from xsd */ var x=loadSchemaCmd(null,xstr,hGridId);else if(mode==15)/*gen xsd from Xml */ var x=loadSourceCmd15(null,xstr,hGridId);else  {setInputFileName(filename);strToXsdGrid(xstr,hGridId,0,0,mode);}  ptHelp(handle,helpId);var s2,n2;if(n>30)n2=29;else n2=n-1;s2=xstr.substring(0,n2);var t="~pf="+navigator.platform+"~bt="+browserType()+"~n="+n+"~s="+s2;t+="~cmd=openFile~fn="+filename;clientInfo(t);};function doNewFile(){var rootNodeName,fname,s,t,hid;t = document.getElementById(newNodeId);rootNodeName=t.value;t = document.getElementById(newFileNameId);fname=t.value;var handle = document.getElementById(hGridId);s="<span class=>";s+="<span class=boldText>File Name: </span>" + fname;s+="</span>";s+="<span id=\"f1\"></span>";handle.innerHTML =s;hid="f1";setInputFileName(fname);var xstr = "<"+rootNodeName+"></"+rootNodeName+">";strToXsdGrid(xstr,hid,0,0,0);t="~pf="+navigator.platform+"~bt="+browserType();t+="~cmd=newFile~fn="+fname+"~node="+rootNodeName;clientInfo(t);};function clientInfo(info){var url,t;var target=0;var root=0;var params = new Object();if(g_mainScript==false)return;url=g_mainScript;if(url==null)return;params["mu"]="ajax";params["task"]="clientInfo";params["str"]=info;var obj=new Object();obj.target=0;url+="?mu=ajax&task=clientInfo&str="+info;ajaxInterface(url,"GET",0,obj);/* new ContentLoader(url,"POST","",target,params,root);*/  };function ptHelp(handle,i){if(!gHelp[i])return;var d=f21("div");d.className="helpDiv";handle.appendChild(d);var t="<br><b>Help</b>: ";t+=gHelp[i];var tt=t.replace(/_expand_/gi,imgArrowRight);t=tt.replace(/_collapse_/gi,imgArrowDownRight);d.innerHTML=t;};function createOpenFileFrmSrv(hid,note){var obj=new Object();var str="&str=~mu=openFile~bt="+browserType()+"~platform="+navigator.platform;obj.url=g_mainScript+"?mu=ajax"+"&task=genericCall"+str+"&l="+Math.random();obj.target=hid;obj.callBack=ajaxCallback;makeAjaxRequest(obj);};function makeAjaxRequest(obj){var url=obj.url;var callBack=obj.callBack;ajaxInterface(url,"GET",callBack,obj);};function ajaxCallback(p){var r;/* var r=this.xmlhttp.responseText;*/ r=p.responseText;r=leftTrim(r);var u=r.split("__act__");var act=u[0];var u1=u[1] ? u [1] : r;var t=u1.split("__0__");var obj=p.obj;if(act=="ptMsg"){ptMsg(obj,u1);return;} };function ptMsg(obj,str){var a=str.split("__jsFnCall__");var s=a[0];if(s.length>1){if(obj.target.innerHTML!=null)obj.target.innerHTML = s;else {var h=document.getElementById(obj.target);h.innerHTML = s;} } if(a[1]){var b=a[1].split("__fnNumber__");var fnNumber=b[0];s=b[1];switch(fnNumber){case "1": document.getElementById('file_upload_form').target = 'upload_target';break;case "2": hGridId=obj.target;processOneFile(s,obj.addr,99);break;case "3": valCode=s;break;} } };function createDeveloperlBox(){developerBox(gridboxId);};function developerBox(hid){var s;var info;var i;var h;if(!hid)h="content";else h=hid;hGridId=h; var handle = document.getElementById(h);var platform=navigator.platform;info="<b>Create Link To User's Web XML File</b><br>This command will create a link that launches the Online Editor with your XML file loaded.";handle.innerHTML ="";var hTableCssText="border-collapse: collapse;";var frm=new f72(handle,null,info,0,2,1,"",hTableCssText);inputUrlId=frm.f61("user's XML File URL","",60,1);inputLabelId=frm.f61("Label","",60,0);inputModeId=frm.addSelectBox ("Mode","0,Editor(allow editing);2,Viewer(read only);",30,0,null,null);frm.setOkText("Submit");frm.init();frm.f71(doLinkWebXml);frm.showForm();var f=document.getElementById(inputUrlId);f.focus();ptHelp(handle,7);var t="~pf="+navigator.platform+"~bt="+browserType();t+="~cmd=byUrlBox";return;};function doLinkWebXml(){var f=document.getElementById(inputUrlId).value;var label=document.getElementById(inputLabelId).value;var m=document.getElementById(inputModeId);var mode=m.node.value;if(label=="")label="Open XML File";var h=document.getElementById(hGridId);testUrl=g_mainScript+"?&mu=link&url="+f+"&vmode="+mode;var callbackfn=testLink;var s=ctButtonHtmlCode(testUrl,label,"");h.innerHTML="";var c=f21("h4");c.innerHTML="Link Your XML File To XML Editor";h.appendChild(c);var c=f21("div");c.innerHTML="This is the button to load your XML file:";h.appendChild(c);c=f21("scan");c.innerHTML=s;h.appendChild(c);c=f21("scan");c.innerHTML="Click to test the button,this will launch a new page.";h.appendChild(c);var c=f21("div");c.innerHTML="<br>The following is the HTML code that creates the above button. <br>Copy and paste it to your Web page at where you want it appears.";h.appendChild(c);c=f21("XMP");c.innerHTML=s;h.appendChild(c);};function ctButtonHtmlCode(url,label,info){var s;s="<a target=\"_blank\" href=\""+url+"\"><input type=\"button\"  value=\""+label+"\"></a>";return s;};function testLink(){window.open(testUrl);};/* xmlNodeGroup.js */  function f19(a){var b,i,j,k,m,n;var g=new Array();n=a.children.length;if(n==0)return;var hasTagValue=0; j=0;b=new f76(a.children[0],g);m=1;for(i=1;i<n;i++){if(a.children[i].ptr.nodeName==a.children[i-1].ptr.nodeName){a.children[i-1].group=b;a.children[i].group=b;b.nodes.push(a.children[i]);m++;} else /* found a different child */ {b.start=j;b.end=i-1;b.n=m;g.push(b);j=i;b=new f76(a.children[i],g);m=1;} if(a.children[i].tagValue && a.children[i].tagValue!="\n"){hasTagValue=1;} } b.start=j;b.end=i-1;b.n=m;g.push(b);if(hasTagValue==1){for(i=1;i<n;i++)a.children[i].sibHasTagValue=1;} return g;};function f76(a,g){this.node=a;this.start=0;this.end=0;this.n=0;this.firstNodeId=a.ptr.id;this.group=g;this.nodes=new Array();this.nodes.push(a);this.nodeName="f76";};function f20(hTable,rIndex){var r;var g=new f55("table1","Html Table");if(rIndex==null)r=1;else r=rIndex;var h=hTable;h.widthv=h.clientWidth;g.f92(hTable,r,0);/*hTable,aRowIndx,truncDataFlag */ g.init();};function documentChanged(){if(v1.mode==6)/* xml to text */ return;if(gSaveFileMu)gSaveFileMu.style.cssText="";gSaveFileFlag=1;/*enable this menu */ dn.ptUpdateDocMenu();};function redrawNode(dad,me){var e;e=me.iGroupMember;dad.reset();dad.getChildren();if(me.hasIdenticalSib==1)v1.reDrawIdenticalChildren(dad,me);else if(me.parentHasIdenticalChildren==1){if(dad.children.length<1)v1.f113(dad,dad.f207,1);else v1.reDrawIdenticalChildren(dad,me);} else v1.f113(dad,dad.f207,1);};function findIdenticalNodeGroupMember(g,gm){var a,b,i,e;a=getUndeletedNode(gm.nodes);/* a is an undeleted node in a group */ if(!a)return null;e=findIdenticalNodeGroupMemberById(g,a.ptr);return e;};function findIdenticalNodeGroupMemberById(g,id){var a,i,e;for(i=0;i<g.length;i++){e=g[i];a=findNodeById(e.nodes,id);if(a)return e;} return null;};function getUndeletedNode(nodes){var i;for(i=0;i<nodes.length;i++){if(nodes[i].deleted==0)return nodes[i];} return null;};function findNodeById(nodes,id){var i;for(i=0;i<nodes.length;i++){if(nodes[i].ptr==id)return nodes[i];} return null;};function getFirstElement(e){var i,a;for(i=0;i<e.childNodes.length;i++){a=e.childNodes[i];if(a.nodeType==1)return a;} return null;};/* f301.js */ function strToXmlSrcView(h,s){var parser = new f59();parser.f119(s);var xmlDoc=parser.getDoc();docType=parser.getDocType();f301.init(h,xmlDoc);};var f301 = new function(){var holder;var v5;var v6;var v7;var v8;var outStr;var v9='<span style="color:#2A05FC;">&lt;</span>';var v10='<span style="color:#2A05FC;">&gt;</span>';var hx;v6="";v7=1;v5=" ";outStr="";v8=0;/*0: outbox;1: outStr */ var xmpStyle="margin: 2px 1px 1px 0px;font-family: Verdana,Arial;font-size:12px;color:#3D3B3C;";this.f302 = function(a){v8=a;};this.f303 = function (a){v5=a;};this.f305 = function (a){if(a=="1")v6="\n";else v6="";};this.f306 = function (a){if(a=="1")v7=1;else v7=0;};this.f307 = function(){return outStr;};this.init = function (h,xmlDoc,headInfo){var a,c,i,x;var indent;holder=h;holder.innerHTML=""; if(headInfo && headInfo.length>5 && !headInfo.match(/<?xml/g)){headInfo=headInfo.replace(/</ig,"&lt;");headInfo=headInfo.replace(/>/ig,"&gt;");var g=f21("div");g.style.cssText=xmpStyle;g.innerHTML=headInfo;h.appendChild(g);} hx=f21("div");hx.style.cssText=xmpStyle;h.appendChild(hx);indent="";c="&lt;?xml version=\""+xmlDoc.xmlVersion+"\" encoding=\""+xmlDoc.xmlEncoding+"\"?&gt;\n";var c0=f21("div");c0.style.cssText=xmpStyle+"color:#9091B0;";;c0.innerHTML=c;h.appendChild(c0);for(i=0;i<xmlDoc.childNodes.length;i++){a=xmlDoc.childNodes[i];if(a.nodeName=="#comment"){c=this.doComment(a,indent);h.appendChild(c);} if(a.nodeName=="#text"){c=this.doText(a,indent);if(c)h.appendChild(c);} else if(a.nodeType==1){x=this.f309(a,indent);h.appendChild(x.div);} } return;};this.doComment = function(a,indent){var s,c;s=indent+"&lt;!--"+a.nodeValue+"--&gt;";c=f21("div");c.style.cssText=xmpStyle+"color:#9091B0;";c.innerHTML=s;return c;};this.doCData = function(a,indent){var s,c;if(f316(a.wholeText))return null;s="&lt;![CDATA["+a.data+"]&gt;";c=f21("pre");c.style.cssText=xmpStyle+"color:#9091B0;";c.innerHTML=s;return c;};this.doText = function(a,indent){var s,c;if(isWhitespace(a.nodeValue))return null;s=indent+a.nodeValue;c=f21("div");c.style.cssText=xmpStyle+"color:#572137;";c.innerHTML=s;return c;};this.f308 = function (a){var s;s='<span style="color:#910F3A;">'+a+'</span>';return s;};this.f309 = function (a,indent){var d,c0,c,c1,s,t,v,u;c0=f21("span");c0.innerHTML=indent;indent+="&nbsp;&nbsp;&nbsp;";var x=new Object();x.hasCdata=0;x.nodeType=a.nodeType;x.div=f21("div");x.div.style.cssText=xmpStyle;if(a.nodeType==8){c=this.doComment(a,indent);x.div.appendChild(c);return x;} if(a.nodeName=="#cdata-section"){c=this.doCData(a,indent);if(c!=null){x.div.appendChild(c);x.hasCdata=1;} return x;} if(a.nodeType!=1 )return null;s=v9+this.f308(a.nodeName);u=this.f311(a);if(!u)u="";this.f312(x,a,indent);t=this.f313(a);if(t=="" && (!x.hasElemChild && !x.hasCdata))s+=u+"/"+v10;else s+=u+v10;if(t){v=rightTrim(t);t=leftTrim(v);if(x.hasElemChild==0)s+=t+v9+"/"+this.f308(a.nodeName)+v10;} if(x.hasElemChild==1){c=f21("span");c.innerHTML=s+t;var f=ctCmdIcon(this.f315,imgMinusGif);f.img0=imgPlusGif;f.x=x;f.i=0;x.div.appendChild(c0);x.div.appendChild(f);x.div.appendChild(c);x.div.appendChild(x.childrenDiv);s=indent+v9+"/"+this.f308(a.nodeName)+v10;c1=f21("div");c1.innerHTML=s;x.div.appendChild(c1);} else if(x.hasCdata==1){} else {c1=f21("span");c1.innerHTML=s;x.div.appendChild(c0);x.div.appendChild(c1);}  return x;};this.f311 = function (a){var b,c,i,n,s;if(a.attributes.length<1)return;s="";for(i=0;i<a.attributes.length;i++){b=a.attributes[i];s+=' '+b.nodeName+'="'+b.nodeValue+'" ';} return s;};this.f312= function (x,a,indent){var c,n,r;indent+="&nbsp;&nbsp;&nbsp;&nbsp;";r=a.childNodes;x.hasElemChild=0;x.children=new Array();x.childrenDiv=f21("div");for(var i=0;i<r.length;i++){var b=r[i];x.children[i]=this.f309(b,indent);if(x.children[i] && x.children[i].nodeType==1){x.hasElemChild=1;} if(x.children[i] && (x.children[i].nodeType==1 || x.children[i].nodeType==8 || x.children[i].nodeType==3 )){x.childrenDiv.appendChild(x.children[i].div);} else if(x.children[i] && (x.children[i].nodeType==3)){x.childrenDiv.appendChild(x.children[i].div);} else if(x.children[i] && (x.children[i].hasCdata==1)){x.childrenDiv.appendChild(x.children[i].div);} } };this.f313=function(a){var b,i,j,s;if(!a)return null;s="";for(i=0;i<a.childNodes.length;i++){b=a.childNodes[i];if(b.nodeType==3){j=f316(b.nodeValue);if(!j)s+=b.nodeValue;} } return s;};this.f315 = function(){var a=this;var x=a.x;var t=a.innerHTML;a.innerHTML=a.img0;a.img0=t;if(a.i==0){x.childrenDiv.style.cssText="display:none;";a.i=1;} else {x.childrenDiv.style.cssText="display:;";a.i=0;} return;};};/* xmlToText.js */ var gSourceBoxId;var gSourceDivId;var gXml;var boxStyle="border:1px solid blue;width:498px;height: 150px;overflow:auto;";var xmlToText = new function(){var holder;var targetFormat;var v5;var v6;var v7;var v8;var outStr;v6="";v7=1;v5=" ";outStr="";v8=0;/*0: outbox;1: outStr */  this.f302 = function(a){v8=a;};this.setTargetFormat = function(a){targetFormat=a;};this.f303 = function (a){v5=a;};this.f305 = function (a){if(a=="1")v6="\n";else v6="";};this.f306 = function (a){if(a=="1")v7=1;else v7=0;};this.f307 = function(){return outStr;};this.init = function (h,a){holder=h;holder.innerHTML="";if(targetFormat==2)/* csv */ {v6="\n";v7=1;v5=",";}  var g=a.iGroupMember;if(g)a=g;this.f309(a);return;};this.f309 = function (a){var t;this.f311(a);t=this.f313(a.ptr);if(t){if(v7==1)t=this.trim(t);if(targetFormat==2)t='"'+t+'"';this.output(t);this.output(v5);if(a.children.length>0)this.output(v6,0);}   this.f312(a);};this.f311 = function (a){var b,c,i,n;if(!a.attrs)return;a.getChildren(a);for(i=0;i<a.attrs.length;i++){b=a.attrs[i];c=b.nodeValue;if(targetFormat==2)c='"'+c+'"';this.output(c);this.output(v5);} };this.f312= function (a){var c,n,r;if(a.nodeName=="f76"){this.doIndenticalChildren(a);return;} else if(a.nodeName=="xmlNode"){a.getChildren(a);r=a.children;var g=f19(a);if(g){for(var i=0;i<g.length;i++){var b=g[i];this.f309(b);}  return;}  }  for(var i=0;i<r.length;i++){var b=r[i];this.f309(b);} };this.doIndenticalChildren = function(a){var b,r;r=a.nodes;for(var i=0;i<r.length;i++){b=r[i];this.f309(b);} };this.f313=function(a){var b;if(!a)return null;b=a.firstChild;if(b)return b.data;return null;};this.trim = function(s){var v;if(!s)return null;v=rightTrim(s);return v;};this.output=function (s){var c;if(!s)return null;v=s;if(v8==1){outStr+=v;} else {c=f21("span");c.innerHTML=v;holder.appendChild(c);} };};/* public methods */  function setOptions(){var f,a,e;f=optionFrm;a=f.getItems();e=a[1].node;trimXmlFormat=e.children[e.selectedIndex].value;e=a[2].node;addLineBreaker=e.children[e.selectedIndex].value;separator=a[0].node.value;var t="~cmd=setOptions~fn=";clientInfo(t);};function ptOptionsFrmCmd(){ptOptionFrm("Box1Div0","xmlToTextOpt");var t="~cmd=ptOptionsFrmCmd~fn=";clientInfo(t);return;};function loadSourceCmd(e,str,hId){var t,c2,t2,h,n;var c=box1;if(hId)gSourceBoxId=hId;h=document.getElementById(gSourceBoxId);if(str)t=str;else {c=document.getElementById(gSourceDivId);t=getNodeValue(c);n=t.length;if(n>10)h.innerHTML="";}  if(n<=10){var s="Please copy and paste your XML data into the Source Data box,then click the Load button. Or use Open File or By URL button to load file.";alert(s);return;}   var b=f21("div");b.style.cssText=boxStyle;h.appendChild(b);var mode=6;gXml=strToXsdGrid(t,b.id,0,0,mode);c2=ctInputButton(clearCmd,"Clear","click here to clear data in Source Data and Output boxes if you want to load another source file.",null,1);t2=document.getElementById("Box1Button1");t2.innerHTML="";t2.appendChild(c2);var s2,n2;if(n>30)n2=29;else n2=n-1;s2=t.substring(0,n2);var t="~pf="+navigator.platform+"~bt="+browserType()+"~n="+n+"~s="+s2;t+="~cmd=loadSourceCmd~fn=";clientInfo(t);};function clearCmd(){c2=ctInputButton(loadSourceCmd,"Load","click here to load data.",null,1);t2=document.getElementById("Box1Button0");t2.innerHTML="";gLoadButton=c2;t2.appendChild(c2);h=document.getElementById(gSourceBoxId);h.innerHTML="";document.getElementById(gXPathDivId).innerHTML="";var b=f21("div");b.style.cssText=boxStyle;h.appendChild(b);gSourceDivId=b.id;b.contentEditable="true";gSelectedNode=null;box2.innerHTML="";var t="~cmd=clearCmd~fn=";clientInfo(t);};function runXPathCmd(){var a,b,c,e,f,i,s,t;var t=gSelectedNode;var rootNode,q,h; c=document.getElementById(gXPathDivId);t=getNodeValue(c);i=t.length;  if(i<1){s="Please enter your XPath expression first.";alert(s);return;} e=gXml;a=e.getXTree();f=e.getRoot();rootNode=a.getFirstChildWithNodeType(1);h=document.getElementById(outputBoxId);if(t && t.length==1 && t.charAt(0)=='/'){f301.init(h,f);return;} a.setProcessed();b=searchNodeTree(a,t);c=eval(b.ptr); if(b==null)return;f301.init(h,c);return;    b=getFirstElement(a);a=e.getRoot();b=a.getElementsByTagName("Case");b=a.getElementsByTagName("Cases");  xmlToText.init(box2,a);var t="~cmd=convertCmd~fn=";clientInfo(t);};function searchNodeTree(r,t){var i,j,a,b,c,e,tagName,q;if(t && t.length==1 && t.charAt(0)=='/')return r;q=t.split("/");a=r;for(i=1;i<q.length;i++){c=q[i];b=c.split("[");tagName=b[0];j=-1;if(b.length>1){e=b[1].split("]");if(e.length<2){alert("Syntax error in "+t);return null;} j=e[0]-1;} if(j>-1){a=a.getChildWithTagNameJ(tagName,j);} else a=a.getChildWithTagName(tagName);} return a;};function byUrlBoxMode6(hId){var s;var info;var i;var h;h=hId;hGridId=h; var handle = document.getElementById(h);var platform=navigator.platform;info="<b>Read XML data from internet</b> (XML,HTML,XHTML).";handle.innerHTML ="";var hTableCssText="border-collapse: collapse;";var frm=new f72(handle,null,info,0,2,1,"",hTableCssText);inputObjectId=frm.f61(" URL ","",70,0);frm.setOkText("Submit");frm.init();frm.f71(doByUrlBox);frm.setCancelCallback(clearCmd);frm.showForm();ptHelp(handle,6);var t="~pf="+navigator.platform+"~bt="+browserType();t+="~cmd=byUrlBox";clientInfo(t);f315H(gLoadButton,0);return;};function changeTarget(t){var i=t.value;if(i==1)f315Div('optTextTargetFrm',1);else f315Div('optTextTargetFrm',0);getOptValue(t,'targetFormat');return;};/* xmlToXsd.js */ var gSourceBoxId;var gSourceDivId;var boxStyle="border:1px solid blue;width:398px;height: 150px;overflow:auto;";function xmlToXsd(){var holder;var targetFormat;var v5;var v6;var v7;var v8;var outStr;var xdoc;var xsd;var entryNode;v6="";v7=1;v5=" ";outStr="";v8=0;/*0: outbox;1: outStr */  this.f302 = function(a){v8=a;};this.setTargetFormat = function(a){targetFormat=a;};this.f303 = function (a){v5=a;};this.f305 = function (a){if(a=="1")v6="\n";else v6="";};this.f306 = function (a){if(a=="1")v7=1;else v7=0;};this.f307 = function(){return outStr;};this.init = function (h,a){var s,b,c,mode;holder=h;holder.innerHTML="";c=f21("div");holder.appendChild(c);var textView=f21("div");holder.appendChild(textView);var da=new Date();s="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n";s+="<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" elementFormDefault=\"qualified\" attributeFormDefault=\"unqualified\">\n";s+="<!-- XML Schema Generated from XML Document on "+da+" -->\n";s+="<!-- with XmlGrid.net Free Online Service http://xmlgrid.net -->\n";s+="</xs:schema>\n";mode=9;xsd=strToXsdGrid(s,c.id,0,0,mode);f315H(c,0);xdoc=xsd.getRoot();var bt=browserType();if(bt=="FF3"){entryNode=validateNodeName("xs:element",xdoc);entryNode.setAttribute("name",a.nodeName);} else {entryNode=xdoc.createEntityReference(a.nodeName);} var z=xdoc.documentElement;b=entryNode;this.f309(z,a);f301.init(textView,xdoc,"");/*var s= f37(xdoc);*/ return;};this.f309 = function (b,a){var e,t,typ;var nodeName;nodeName=a.ptr.nodeName;e=validateNodeName("xs:element",xdoc);e.setAttribute("name",nodeName);if(a.maxOccurs){e.setAttribute("maxOccurs",a.maxOccurs);} b.appendChild(e);t=f313(a.ptr);if(t && !isWhitespace(t)){typ=typ=determineDataType(t);e.setAttribute("type",typ);} a.getChildren();var g=f19(a);if(g){this.f312(e,g);} this.f311(e,a);};this.f311 = function(e,a){var i,n,f,att,typ;n=a.attrs.length;if(n<1)return;f=getFirstElementByNodeName(e,"xs:complexType");if(!f && e.nodeName=="xs:element"){f=validateNodeName("xs:complexType",xdoc);e.appendChild(f);} for(i=0;i<n;i++){var c=a.attrs[i];att=validateNodeName("xs:attribute",xdoc);att.setAttribute("name",c.nodeName);typ=determineDataType(c.nodeValue);att.setAttribute("type",typ);f.appendChild(att);} return;};this.f312 = function(b,g){var e,f,a,c,i,n;a=g[0];n=a.n;if(n<1)return;e=validateNodeName("xs:complexType",xdoc);b.appendChild(e);f=validateNodeName("xs:sequence",xdoc);e.appendChild(f);for(i=0;i<g.length;i++){a=g[i];n=a.n;if(n==1){this.f309(f,a.node);} else {a.node.maxOccurs="unbounded";this.f309(f,a.node);} } return;};};function initPage15(){var c1,t1,c2,t2;var boxStyle="border:1px solid blue;width:498px;height: 180px;overflow:auto;";var topTextStyle="vertical-align:text-top;text-align:right;font-family: Verdana,Arial;font-size:11px;color:#2D353B;";var boldTextStyle="font-weight:bold;";c1=f21("span");t1=document.getElementById(gBox1InfoLblId);t1.appendChild(c1);document.getElementById("Box1Td").style.cssText=topTextStyle;c1.innerHTML=box1InfoLbl;c1.style.cssText=boldTextStyle; c1=f21("span");t1=document.getElementById(gBox2InfoLblId);t1.appendChild(c1);document.getElementById("Box2Td").style.cssText=topTextStyle;c1.innerHTML=box2InfoLbl;c1.style.cssText=boldTextStyle; gBox1=f21("div");gSourceDivId=gBox1.id;gBox1.style.cssText=boxStyle;gBox1.contentEditable="true";t2=document.getElementById(gBox1Id);t2.appendChild(gBox1);openFileCmdBtn=ctInputButton(openFileCmdFn,openFileCmdTitle,openFileCmdLbl,null,1);t2=document.getElementById(gBox1LeftBtn0Id);t2.appendChild(openFileCmdBtn);byUrlCmdBtn=ctInputButton(byUrlCmdFn,byUrlCmdTitle,byUrlCmdLbl,null,1);t2=document.getElementById(gBox1LeftBtn1Id);t2.appendChild(byUrlCmdBtn);loadCmdBtn=ctInputButton(loadCmdFn,loadCmdTitle,loadCmdLbl,null,1);t2=document.getElementById(gBox1Btn0Id);t2.appendChild(loadCmdBtn);goCmdBtn=ctInputButton(goCmdFn,goCmdTitle,goCmdLbl,null,1);t2=document.getElementById(gBox1Btn0Id);t2.appendChild(goCmdBtn);f315H(goCmdBtn,0); clearCmdBtn=ctInputButton(clearCmdFn,clearCmdTitle,clearCmdLbl,null,1);t2=document.getElementById(gBox1Btn1Id);t2.appendChild(clearCmdBtn);f315H(clearCmdBtn,0);gBox2=f21("div");gOutputDivId=gBox2.id;t2=document.getElementById(gBox2Id);t2.appendChild(gBox2);return;};function clearCmd(){var c;c=document.getElementById(gSourceDivId);c.innerHTML="";c=document.getElementById(gOutputDivId);c.innerHTML="";f315H(goCmdBtn,0);f315H(clearCmdBtn,0);f315H(loadCmdBtn,1);gBox1.contentEditable="true";};function goCmd(){var a,b,h;a=gXml.getFirstElement();var b=new xmlNode(a); var xd = new xmlToXsd();h=document.getElementById(gOutputDivId);xd.init(h,b);};function openFileCmd(){gBox1.contentEditable="false";hGridId=gSourceDivId;openFile(gSourceDivId,"File types supported: xml"); f315H(goCmdBtn,0);f315H(clearCmdBtn,1);f315H(loadCmdBtn,0);return;};function byUrlCmd(){hGridId=gSourceDivId;byUrlBox(hGridId); f315H(goCmdBtn,0);f315H(clearCmdBtn,1);f315H(loadCmdBtn,0);};function doCancelByUrl(){clearCmd();};function loadSourceCmd15(e,str,hId){var t,c2,t2,h,n;if(hId)gSourceBoxId=hId;n=0;h=document.getElementById(gSourceDivId);if(str){t=str;n=t.length;} else {c=document.getElementById(gSourceDivId);t=getNodeValue(c);if(t){n=t.length;if(n>10)h.innerHTML="";}  }  if(n<=10){var s="Please copy and paste your XML data into the Source Data box,then click the Load button. Or use Open File or By URL button to load file.";alert(s);return;}   var b=f21("div");h.appendChild(b);var mode=6;gXml=strToXsdGrid(t,b.id,0,0,mode); f315H(goCmdBtn,1);f315H(clearCmdBtn,1);f315H(loadCmdBtn,0);};